const t=()=>{const t=new WeakMap;return(e,n)=>t.get(e)||n&&t.set(e,n).get(e)},e=t(),n=t(),o=new Map,s=t(),r=t(),c=t(),i=t(),a=t(),l=(t,e,...n)=>{const o=s(e);if(o)for(const s of o[t]||[])o[t].includes(s)&&s(e,...n)},h=t=>{const e=[t];let n;for(;n=e.shift();){for(const t of c(n,[]))t();for(const t of n.childNodes)e.push(t)}},u=(t,e,n,o)=>{const r=s(t,{});r[n]?r[n].push(o):r[n]=[o];c(e,[]).push((()=>{const e=s(t);e&&e[n]&&(e[n]=e[n].filter((t=>t!==o)))}))},f=(t,e,n,o={})=>{t.dispatchEvent(new CustomEvent(e,{bubbles:!0,cancelable:!1,composed:!0,detail:n,...o}))},p=(t,e,n,s={})=>{const r=o.get(t);r&&f(r,e,n,s)},d=(t,e)=>{if(t)m(t,e);else for(const t of o.keys())m(t)},m=(t,n)=>{const s=o.get(t),r=e(s.constructor);if(t.onChange)for(const e of[...r.prop||[],...r.attr||[]])t.onChange(e,t[e],t[e]);l(`set:${n||""}`,t)},g=t=>t.entries?t.entries():Object.entries(t),b=t=>{const e=new Map;return n=>{if(e.has(n))return e.get(n);const o=t(n);return e.set(n,o),o}},w=t=>t.replace(/-(\p{Ll})/gu,(t=>t[1].toUpperCase())),y=t=>t.replace(/\p{Lu}/gu,(t=>`-${t[0]}`.toLowerCase())),v=t=>null==t?"":`${t}`,$=t=>"string"==typeof t,C=(t,e)=>t.getAttribute(e),E=t=>{const e=o.get(t);return e?e.shadowRoot||e:null},M=(t,e,n)=>{!0===n&&(n=""),$(n)?t.setAttribute(e,n):t.removeAttribute(e)},L=(t,e)=>[...new Set([...t,...e])],S=(t,e)=>"function"==typeof t[e]?t[e].bind(t):t[e],T=document,x=window,k=t=>t.cloneNode(!0),N=t=>T.createElement(t),A=()=>T.createDocumentFragment(),P=t=>{const e=N("style");return e.appendChild((t=>T.createTextNode(t))(t)),e},j=()=>N("template"),H=(t,e)=>T.createTreeWalker(t,e),O=t=>{const e=T.implementation.createHTMLDocument(""),n=e.createElement("style");return n.textContent=t,e.body.appendChild(n),n.sheet.cssRules},D=(t,e,n)=>{const o=i(t,{});let s=o[e];if(!s){let n=t[e];const r=Object.getOwnPropertyDescriptor(t,e)||{};s=[],o[e]=s,Object.defineProperty(t,e,{get:r.get||(()=>n),set:function(t){const e=n;if(t!==e){r.set?r.set(t):n=t;for(const n of s)n(this,t,e)}}})}s.push(n)};function R(t,e,n,o,s){u(t,e,"set:",n);for(const r of o){const o=`set:${r}`;r in s?(D(s,r,((e,n,s)=>{l(o,t,n,s)})),u(s,e,o,n)):(D(t,r,((t,e,n)=>{l(o,t,e,n),t.onChange&&t.onChange(r,e,n)})),u(t,e,o,n))}}const I=t=>{let e=a(t),n=t.parentNode;for(;!e&&n;)e=a(n),n=n.parentNode;return e||(e={},a(T.body,e)),e},K=(t,e)=>{const n=Object.create(t);return a(e,n),n},V=(t,e)=>new Proxy(t,{get:(t,n)=>S(n in e?e:t,n)});let G="",F=0,W=0;const _={b:"\b",f:"\f",n:"\n",r:"\r",t:"\t",v:"\v"},J={"-":t=>e=>-t(e),"!":t=>e=>!t(e),"~":t=>e=>~t(e),"+":t=>e=>+t(e)},U={"||":[1,(t,e)=>n=>t(n)||e(n)],"&&":[2,(t,e)=>n=>t(n)&&e(n)],"|":[3,(t,e)=>n=>t(n)|e(n)],"^":[4,(t,e)=>n=>t(n)^e(n)],"&":[5,(t,e)=>n=>t(n)&e(n)],"==":[6,(t,e)=>n=>t(n)==e(n)],"!=":[6,(t,e)=>n=>t(n)!=e(n)],"===":[6,(t,e)=>n=>t(n)===e(n)],"!==":[6,(t,e)=>n=>t(n)!==e(n)],"<":[7,(t,e)=>n=>t(n)<e(n)],">":[7,(t,e)=>n=>t(n)>e(n)],"<=":[7,(t,e)=>n=>t(n)<=e(n)],">=":[7,(t,e)=>n=>t(n)>=e(n)],"<<":[8,(t,e)=>n=>t(n)<<e(n)],">>":[8,(t,e)=>n=>t(n)>>e(n)],">>>":[8,(t,e)=>n=>t(n)>>>e(n)],"+":[9,(t,e)=>n=>t(n)+e(n)],"-":[9,(t,e)=>n=>t(n)-e(n)],"*":[10,(t,e)=>n=>t(n)*e(n)],"/":[10,(t,e)=>n=>t(n)/e(n)],"%":[10,(t,e)=>n=>t(n)%e(n)]},q={true:()=>!0,false:()=>!1,null:()=>null},z=t=>{G=t,F=0,B(0);let e=[()=>{},[]];try{e=et()||Z()}catch(t){}return e},B=(t=1)=>{F+=t,W=G.charCodeAt(F)},Q=()=>G.charAt(F),X=t=>t>=48&&t<=57,Y=t=>t>=65&&t<=90||t>=97&&t<=122||t>=128||36===t||95===t,Z=()=>{const t=`Parse error at index ${F}: ${G}`;throw console.error(t),new Error(t)},tt=()=>{for(;32===W||9===W||10===W||13===W;)B()},et=()=>{const t=ot();return tt(),t},nt=()=>{tt();let t,e=G.substr(F,3),n=3;for(;n>0;){if(t=U[e],t){B(n);break}e=e.substr(0,--n)}return t},ot=()=>{let t,e,n,o,s,r,c;if(s=st(),!s)return s;if(e=nt(),!e)return s;for(r=st()||Z(),o=[s,e,r],c=()=>{let t=o.pop(),e=o.pop(),n=o.pop();o.push([e[1](n[0],t[0]),L(n[1],t[1])])};n=nt();){for(;o.length>2&&n[0]<=o[o.length-2][0];)c();t=st()||Z(),o.push(n,t)}for(;o.length>1;)c();return t},st=()=>{let t;if(tt(),X(W)||46===W)return ct();if(39===W||34===W)t=it();else{const e=J[Q()];if(e){B();const t=st()||Z();return[e(t[0]),t[1]]}Y(W)||Z();const n=at();t=q[n]?[q[n],[]]:[t=>S(t,n),[n]]}return rt(t)},rt=t=>{for(tt();46===W||91===W||40===W||63===W;){let e,n,o=[],s=t;if(63===W&&(B(),tt(),46!==W&&Z(),e=!0),91===W){B();const t=et()||Z();n=(e,n)=>S(e,t[0](n)),o=t[1],93!==W&&Z(),B()}else if(40===W){B();const t=lt();n=(e,n)=>e(...t.map((t=>t[0](n)))),o=t.reduce(((t,e)=>L(t,e[1])),o)}else if(46===W){B(),tt();const t=at();n=e=>S(e,t)}else Z();t=e?[t=>{const e=s[0](t);return void 0===e?void 0:n(e,t)},L(s[1],o)]:[t=>n(s[0](t),t),L(s[1],o)],tt()}return t},ct=()=>{let t="";for(;X(W);)t+=Q(),B();if(46===W)for(t+=".",B();X(W);)t+=Q(),B();if(101===W||69===W){t+=Q(),B(),43!==W&&45!==W||(t+=Q(),B());let e=!0;for(;X(W);)t+=Q(),B(),e=!1;e&&Z()}Y(W)?Z():46!==W&&"."!==t||Z();const e=parseFloat(t);return[()=>e,[]]},it=()=>{let t="";const e=W;for(B();F<G.length&&W!==e;){if(92===W){B();const e=Q();t+=_[e]||e}else t+=Q();B()}return F>=G.length&&Z(),B(),[()=>t,[]]},at=()=>{let t=F;for(Y(W)?B():Z();F<G.length&&(Y(W)||X(W));)B();return G.slice(t,F)},lt=()=>{const t=[];for(tt();41!==W;)F>=G.length&&Z(),t.push(et()||Z()),tt(),44===W?(B(),tt()):41!==W&&Z();return B(),t},ht=t=>{const e=t.split(/{{(.*?)}}/);if(e.length<2)return null;const n=[];let o=!1,s=[];for(const t of e){if(o){const e=z(t);n.push(e[0]),s=L(s,e[1])}else n.push(t);o=!o}return[n,s]},ut=t=>t?[e=>t[0].map((t=>v(t&&t.call?t(e):t))).join(""),t[1]]:null,ft=b((t=>{const e=ht(t);return e&&3===e[0].length&&""===e[0][0]&&""===e[0][2]?[t=>{const n=e[0][1](t);return"boolean"==typeof n?n:v(n)},e[1]]:ut(e)})),pt=b((t=>ut(ht(t)))),dt={window:()=>{},document:()=>{},stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:(t,e)=>t.target!==e,outside:(t,e)=>e.contains(t.target),ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>0!==t.button,middle:t=>1!==t.button,right:t=>2!==t.button,exact:(t,e,n)=>["ctrl","shift","alt","meta"].some((e=>t[`${e}Key`]&&!n.has(e)))},mt=[{"*for":(t,e,n,o)=>{let s="key",r="value";const c=o.match(/^\s*(?:(?:(\S+)\s*,\s*)?(\S+)\s+of\s+)?(\S+)\s*$/);c&&(s=c[1]||s,r=c[2]||r,o=c[3]);const i=z(o),a=I(e);let l=new Map;const u=t=>{const o=i[0](V(t,a))||[];let c=l;l=new Map;let u=e;const f=new Map(c);for(const[t]of g(o))f.delete(t);for(const t of f.values())h(t),t.remove(),c.delete(t);for(const[e,i]of g(o)){let o=c.get(e);if(c.delete(e),o!==u.nextSibling){o&&(h(o),o.remove()),o=k(n);const c=K(a,o);c[s]=e,c[r]=i,$t(o,t),u.after(o)}else{K(a,o)[r]=i}u=o,l.set(e,u)}for(const t of c.values())h(t),t.remove()};R(t,e,u,i[1],a),u(t)},"*if":(t,e,n,o)=>{const s=z(o),r=I(e);let c=null;const i=t=>{s[0](V(t,r))?c||(c=k(n),K(r,c),$t(c,t),e.after(c)):c&&(h(c),c.remove(),c=null)};R(t,e,i,s[1],r),i(t)},"*repeat":(t,e,n,o)=>{let s="index";const r=o.match(/^(\S+)\s+as\s+(\S+)$/);r&&(o=r[1],s=r[2]);const c=z(o),i=I(e);let a=[];const l=t=>{let o=+c[0](V(t,i));for(;a.length>o;){const t=a.pop();h(t),t.remove()}let r=a.length+1,l=a[r-1]||e;for(;a.length<o;){let e=k(n);K(i,e)[s]=r++,$t(e,t),a.push(e),l.after(e),l=e}};R(t,e,l,c[1],i),l(t)}},{"":(t,e,n,o)=>{const s=ft(n);if(s){const n=I(e),r=t=>{M(e,o,s[0](V(t,n)))};R(t,e,r,s[1],n),r(t)}},"@":(t,e,n,o)=>{const[s,...r]=w(o.slice(1)).split("."),c=Object.create(I(e)),i=z(n),a={},l=new Set(r);let h=e;for(const t of["passive","capture","once"])l.has(t)&&(a[t]=!0);l.has("window")&&(h=x),(l.has("document")||l.has("outside"))&&(h=T),h.addEventListener(s,(n=>{r.some((t=>(dt[t]||(e=>{return n=e.key,y(n.replace(/^\p{Lu}/gu,(t=>t.toLowerCase())))!==(t.match(/^code-\d+$/)?String.fromCodePoint(+t.split("-")[1]):t);var n}))(n,e,l)))||(e=>{c.$event=e,i[0](V(t,c))})(n)}),a),M(e,o)},"#ref":(t,e,n,o)=>{t[w(n)]=e,M(e,o)},".":(t,e,n,o)=>{const s=z(n),r=w(o.slice(1)),c=I(e),i=t=>{const n=s[0](V(t,c));e[r]=n};R(t,e,i,s[1],c),i(t),M(e,o)}}],gt=(t,e)=>mt["*"===t.charAt(0)?0:1][t]=e;function bt(t,e){if(1===e.nodeType)for(const n of[...e.attributes]){const o=n.nodeName,s=o.charAt(0),r=mt[1],c=r[o]||r[s]||r[""];c&&c(t,e,n.nodeValue||"",o)}}const wt=(t,e,n)=>{const o=n.attributes;if(1===n.nodeType&&o){let c;for(const[t,e]of g(mt[0])){const n=o.getNamedItem(t);if(n){if(c)throw new Error(`${c[0]} breaks ${t}`);c=[t,e,n.nodeValue||""]}}if(c){const o=(s=`${c[0]}=${r=c[2],JSON.stringify(r)}`,T.createComment(s));return n.before(o),e.previousNode(),n.remove(),M(n,c[0]),c[1](t,o,n,c[2],c[0]),1}}var s,r};function yt(t,e){if(3===e.nodeType){const n=pt(e.textContent||"");if(n){const o=I(e),s=t=>{e.nodeValue=n[0](V(t,o))};return R(t,e,s,n[1],o),s(t),1}}}const vt=(t,e)=>{const n=H(t,133);let o;for(;o=n.nextNode();)"TEMPLATE"===o.nodeName&&vt(o.content,e),wt(e,n,o)||yt(e,o)||bt(e,o)},$t=(t,e)=>{const n=A();n.append(t),vt(n,e)};class Ct extends HTMLElement{constructor(){super()}attributeChangedCallback(t,e,n){const o=w(t),s=r(this);s&&this.#t(s,o,n)}connectedCallback(){const t=this.constructor,s=new(n(t)),c=e(t),i=c.useShadow?this.shadowRoot||this.attachShadow({mode:"open"}):this;r(this,s),o.set(s,this),this.classList.add(c.className),c.style&&i.appendChild(P(c.style)),this.#e(c,s),s.onInit&&s.onInit(),l("init",s);const a=j();a.innerHTML=c.template,vt(a.content,s),i.append(a.content),s.onViewInit&&s.onViewInit()}disconnectedCallback(){const t=r(this);t&&t.onDestroy&&t.onDestroy(),h(this),o.delete(t),this.innerHTML="",this.shadowRoot&&(this.shadowRoot.innerHTML="")}#e(t,e){for(const n of t.prop||[]){const t=(t,e)=>{const o=r(t);this.#t(o,n,e)};D(this,n,t),t(this,this[n]);const s=(t,e)=>{const s=o.get(t);s&&(s[n]=e)};D(e,n,s),s(e,e[n])}for(const n of t.attr||[]){const s=y(n);if(this.#t(e,n,C(this,s)),!(t.prop||[]).includes(n)){D(e,n,((t,e)=>{const n=o.get(t);n&&M(n,s,e)}))}}}#t(t,e,n){const o=t[e];t[e]=n,t.onChange&&t.onChange(e,o,n)}}let Et=new Map,Mt=()=>{var t;Et=x[t="__fudgel"]||(x[t]=Et),Mt=()=>{}};const Lt=(t,e)=>n=>{xt(t,e,n)},St=customElements;let Tt=()=>{const t=O("@scope{}").length>0;return Tt=()=>t,t};const xt=(t,o,s)=>{Mt();const r=`fudgel-${(()=>{const t=Et.get("n")||0;return Et.set("n",t+1),t})()}`,c=Nt(o.style||"",t,r,Tt(),o.useShadow),i={...o,className:r,style:c},a=class extends Ct{static observedAttributes=(i.attr||[]).map(y)};e(a,i),n(a,s||class{});const l=j();l.innerHTML=i.template,kt(l,r),i.template=l.innerHTML,St.get(t)||St.define(t,a)},kt=(t,e)=>{const n=H(t.content,1);let o;for(;o=n.nextNode();)"TEMPLATE"===o.nodeName&&kt(o,e),o.classList.add(e)},Nt=(t,e,n,o,s)=>{const r=t=>{t[At]&&(t[At]=t[At].split(",").map((t=>c(t))).join(","),e="");for(const e of t.cssRules)r(e);return`${o?"@scope{":""}${t.cssText}${o?"}":""}`},c=t=>{const r=t=>`${t}.${n}`,c=(t,e)=>t.replace(/:scope/,e),i=c(t=t.trim(),"")===t;return o?i&&(t=r(t)):s?(t=c(t,":host"),(i||t.includes(" "))&&(t=r(t))):(t=c(t,e),i&&(t=`${e} ${r(t)}`)),t};return[...O(t)].map((t=>r(t))).join("")},At="selectorText",Pt=new Map,jt=[],Ht=t=>{if(jt.includes(t))throw jt.push(t),new Error(`Circular dependency: ${jt.map((t=>`${t.name}`)).join(" -> ")}`);jt.push(t);const e=Pt.get(t)||Pt.set(t,new t).get(t);return jt.pop(),e},Ot=(t,e)=>{Pt.set(t,e)};class Dt{#n=new Map;emit=(t,...e)=>{for(const n of[...this.#o(t)])n(...e)};off=(t,e)=>{const n=this.#o(t);for(let t=n.length-1;t>=0;t-=1)n[t]===e&&n.splice(t,1)};on=(t,e)=>this.#o(t).push(e)&&(()=>this.off(t,e));#o=t=>this.#n.get(t)||this.#n.set(t,[]).get(t)}class Rt extends HTMLElement{#s=A();#r=[];#c=[];#i=[];constructor(){super();let t=this.children,e=t[0];if("TEMPLATE"===e.nodeName)this.#c=Array.from(e.content.children);else for(;t.length>0;){const e=t[0];this.#c.push(e),this.#s.appendChild(e)}}connectedCallback(){this.#a(x,"popstate",this.#l),this.#a(T.body,"click",this.#h),this.#u(x.location.pathname),this.#f(x.history,"pushState",this.#p),this.#f(x.history,"replaceState",this.#p)}disconnectedCallback(){for(;this.#i.length;)this.#i.pop()()}go(t){x.history.pushState(null,"",t)}#d(t){let e=!1;if(t.e!==this.#r[0]){const n=C(t.e,"title"),o=C(t.e,"component");this.innerHTML="",n&&(T.title=n),this.#r=[t.e,o?N(o):k(t.e)],e=!0}const n=this.#r[1];for(const[e,o]of t.g)M(n,y(e),o);e&&this.appendChild(n)}#h(t){if(!t.defaultPrevented){const e=t.composedPath().filter((t=>"A"===t.tagName))[0];e&&e.href&&e.origin===x.location.origin&&(t.preventDefault(),this.go(`${e.pathname}${e.search}${e.hash}`))}}#a(t,e,n){const o=n.bind(this);t.addEventListener(e,o),this.#i.push((()=>t.removeEventListener(e,o)))}#m(t){for(const e of this.#c){const n=C(e,"path")||"**",o=C(e,"regexp");let s=n;$(o)||(s=n.replace(/\*+/g,(t=>t.length>1?".*":"[^/]*")).replace(/:[^:\/]+/g,(t=>`(?<${t.slice(1)}>[^/]+)`)));const r=new RegExp(`^${s}(/.*)?$`),c=t.match(r);if(c)return{e,g:Object.entries(c.groups||{})}}return null}#p(t,e){return(n,o,s)=>{e.call(t,n,o,s),this.#u(s||"/")}}#f(t,e,n){const o=t[e];t[e]=n.call(this,t,o),this.#i.push((()=>t[e]=o))}#l(){this.#u(x.location.pathname)}#u(t){const e=this.#m(t);e&&this.#d(e),f(T.body,"routeChange",t)}}const It=(t="router-outlet")=>{customElements.define(t,Rt)},Kt=(t,...e)=>String.raw({raw:t},...e),Vt=Kt;export{Lt as Component,Ct as CustomElement,Dt as Emitter,Rt as RouterComponent,gt as addDirective,xt as component,Vt as css,It as defineRouterComponent,Ht as di,Ot as diOverride,f as dispatchCustomEvent,p as emit,C as getAttribute,Kt as html,o as metadataControllerElement,pt as parseText,ft as parseTextAllowBoolean,E as rootElement,M as setAttribute,d as update,m as updateController};