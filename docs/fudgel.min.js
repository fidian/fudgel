const t=(...t)=>new Set(t.flatMap(t=>[...t])),s=t(),o=t(),e=Symbol();class n{constructor(){this.i=new Map}emit(t,...s){for(const o of[...this.i.get(t)??[]])o(...s)}off(t,s){const o=this.i.get(t)?.filter(t=>t!==s);o?this.i.set(t,o):this.i.delete(t)}on(t,s){return(this.i.get(t)??this.i.set(t,[]).get(t)).push(s),()=>this.off(t,s)}}const c=new n,r=(t,s,...o)=>{c.emit(s,t,...o),t[e]?.events.emit(s,...o),t[`on${s[0].toUpperCase()}${s.slice(1)}`]?.(...o)},i=(t,s,o,e={})=>{t.dispatchEvent(new CustomEvent(s,{bubbles:!0,cancelable:!1,composed:!0,detail:o,...e}))},l=(t,s,o,n={})=>{const c=t[e]?.host;c&&i(c,s,o,n)},f=t=>{if(t)h(t);else for(const t of o)h(t)},h=s=>{const{attr:o,prop:n}=s[e];for(const e of t(n,o))r(s,"change",e,s[e],s[e]);s[e]?.events.emit("update")},a=Object,u=t=>t.replace(/-(\p{Ll})/gu,t=>t[1].toUpperCase()),d=t=>t.replace(/\p{Lu}/gu,t=>`-${t[0]}`.toLowerCase()),p=t=>`${t??""}`,m=t=>"string"==typeof t,$=(t,s)=>t.getAttribute(s),w=(t,s)=>a.hasOwn(t,s),b=(t,s,o)=>{!0===o&&(o=""),m(o)?t.setAttribute(s,o):t.removeAttribute(s)},g=t=>t.entries?.()??a.entries(t),y=t=>"TEMPLATE"==t.nodeName,k=document,C=window,v=t=>t.cloneNode(!0),S=t=>k.createElement(t),L=()=>k.createDocumentFragment(),E=()=>S("template"),M=(t,s)=>k.createTreeWalker(t,s),x=t=>{const s=k.implementation.createHTMLDocument(""),o=s.createElement("style");return o.textContent=t,s.body.append(o),o.sheet.cssRules||[]},_=(t,s,o)=>t.classList.toggle(s,o),T=()=>{const t=new WeakMap;return(s,o)=>(o?t.set(s,o):t).get(s)},O=T(),A=(t,s,o)=>{const e=O(t)||O(t,{});let n=e[s];if(!n){let o=t[s];const c=a.getOwnPropertyDescriptor(t,s)||{};n=[],e[s]=n,a.defineProperty(t,s,{get:c.get||(()=>o),set:function(t){const s=o;if(!a.is(t,s)){c.set?.(t),o=t;for(const o of n)o(t,s)}}})}n.push(o)},H=(t,s,o,n,c)=>{for(const r of n){const n=N(t,c,r);A(n,r,o);const i=()=>{for(const t of f)t?.()},l=t[e]?.events,f=[l?.on("update",o),l?.on("unlink",t=>{t.contains(s)&&i()}),l?.on("destroy",i)]}},N=(t,s,o)=>w(s,o)?s:w(s,e)?t:N(t,a.getPrototypeOf(s),o),P=T(),j=t=>{let s=P(t);if(t){let o=t.parentNode;for(;!s&&o;)s=P(o),o=o.parentNode}return s||P(k.body)||P(k.body,{[e]:!0})},I=(t,s)=>P(s,a.create(t)),K=t=>{const s=new Error(t);throw console.error(s),s};let D="",F=0,G=0,J=!1;const R={b:"\b",f:"\f",n:"\n",r:"\r",t:"\t",v:"\v"},W={"-":t=>s=>[-t(s)[0]],"!":t=>s=>[!t(s)[0]],"~":t=>s=>[~t(s)[0]],"+":t=>s=>[+t(s)[0]],typeof:t=>s=>[typeof t(s)[0]]},q={"||":[3,(t,s)=>o=>[t(o)[0]||s(o)[0]]],"??":[3,(t,s)=>o=>[t(o)[0]??s(o)[0]]],"&&":[4,(t,s)=>o=>[t(o)[0]&&s(o)[0]]],"|":[5,(t,s)=>o=>[t(o)[0]|s(o)[0]]],"^":[6,(t,s)=>o=>[t(o)[0]^s(o)[0]]],"&":[7,(t,s)=>o=>[t(o)[0]&s(o)[0]]],"===":[8,(t,s)=>o=>[t(o)[0]===s(o)[0]]],"==":[8,(t,s)=>o=>[t(o)[0]==s(o)[0]]],"!==":[8,(t,s)=>o=>[t(o)[0]!==s(o)[0]]],"!=":[8,(t,s)=>o=>[t(o)[0]!=s(o)[0]]],"<<":[10,(t,s)=>o=>[t(o)[0]<<s(o)[0]]],">>>":[10,(t,s)=>o=>[t(o)[0]>>>s(o)[0]]],">>":[10,(t,s)=>o=>[t(o)[0]>>s(o)[0]]],"<=":[9,(t,s)=>o=>[t(o)[0]<=s(o)[0]]],"<":[9,(t,s)=>o=>[t(o)[0]<s(o)[0]]],">=":[9,(t,s)=>o=>[t(o)[0]>=s(o)[0]]],">":[9,(t,s)=>o=>[t(o)[0]>s(o)[0]]],instanceof:[9,(t,s)=>o=>[t(o)[0]instanceof s(o)[0]]],in:[9,(t,s)=>o=>[t(o)[0]in s(o)[0]]],"+":[11,(t,s)=>o=>[t(o)[0]+s(o)[0]]],"-":[11,(t,s)=>o=>[t(o)[0]-s(o)[0]]],"**":[13,(t,s)=>o=>[t(o)[0]**s(o)[0]],1],"*":[12,(t,s)=>o=>[t(o)[0]*s(o)[0]]],"/":[12,(t,s)=>o=>[t(o)[0]/s(o)[0]]],"%":[12,(t,s)=>o=>[t(o)[0]%s(o)[0]]]},z={true:!0,false:!1,null:null,undefined:void 0},B=()=>[()=>[],t()],Q=(t=1)=>{F+=t,G=D.charCodeAt(F),J=G>=0},U=()=>D.charAt(F),V=(t=G)=>t>47&&t<58,X=(t=G)=>t>64&&t<91||t>96&&t<123||t>127||36==t||95==t,Y=t=>X(t)||V(t),Z=()=>{K(`Parse error at index ${F}: ${D}`)},tt=(t=0)=>{for(t&&Q(t);32==G||9==G||10==G||13==G;)Q()},st=()=>{const s=()=>{const s=n.pop(),o=n.pop(),e=n.pop();n.push([o[1](e[0],s[0]),t(e[1],s[1])])},o=et();if(!o)return o;let e=ot(q);if(!e)return o;const n=[o,e,et()||Z()],c=t=>t[2]^e[0]<=t[0];for(;e=ot(q);){for(;n.length>2&&c(n[n.length-2]);)s();n.push(e,et()||Z())}for(;n.length>1;)s();return n[0]},ot=t=>{for(const s of a.keys(t))if(!(D.substr(F,s.length)!=s||X()&&Y(D.charCodeAt(F+s.length))))return tt(s.length),t[s]},et=()=>{let s;if(V()||46==G)return ct();if(34==G||39==G){const o=rt();s=[()=>[o],t()]}else if(91===G)tt(1),s=lt(93,!0);else if(123===G)s=ft();else{const o=ot(W);if(o){const t=et()||Z();return[o(t[0]),t[1]]}const e=it();s=e in z?[()=>[z[e]],t()]:[t=>t[e],t([e])]}return nt(s)},nt=s=>{for(;46==G||91==G||40==G||63==G;){let o,e,n=t(),c=s;if(63==G){if(Q(),46!==G)return Q(-1),s;o=!0}if(91==G){tt(1);const t=st()||Z();e=(s,o)=>[s[0][t[0](o)[0]],s[0]],n=t[1],93!==G&&Z(),tt(1)}else if(40==G){tt(1);const t=lt(41);e=(s,o)=>[s[0].apply(s[1],t[0](o)[0])],n=t[1]}else if(46==G){tt(1);const t=it();e=s=>[s[0][t],s[0]]}else Z();s=o?[t=>{const s=c[0](t);return null==s[0]?[]:e(s,t)},t(c[1],n)]:[t=>e(c[0](t),t),t(c[1],n)],tt()}return s},ct=()=>{let s="";for(;V();)s+=U(),Q();if(46==G)for(s+=".",Q();V();)s+=U(),Q();if(101==G||69==G){s+=U(),Q(),43!=G&&45!=G||(s+=U(),Q()),V()||Z();do{s+=U(),Q()}while(V())}X()?Z():46!=G&&"."!=s||Z(),tt();const o=parseFloat(s);return[()=>[o],t()]},rt=()=>{let t="";const s=G;for(Q();J&&G!=s;){if(92==G){Q();const s=U();t+=R[s]||s}else t+=U();Q()}return J||Z(),tt(1),t},it=()=>{let t=F;for(X()||Z(),Q();J&&Y();)Q();const s=D.slice(t,F);return tt(),s},lt=(s,o)=>{const e=[];for(;G!==s;)J||Z(),e.push(o&&44==G?B():st()),44==G?tt(1):G!==s&&Z();return tt(1),[t=>[e.map(s=>s[0](t)[0])],t(...e.map(t=>t[1]))]},ft=()=>{tt(1);const s=[];for(;125!==G;){let o,e;J||Z(),V()||46==G?e=ct():34==G||39==G?o=rt():91==G?(tt(1),e=st(),93!=G&&Z(),tt(1)):o=it(),o&&(e=[()=>[o],t()]),58==G?(tt(1),s.push([e,st()])):o?s.push([e,[t=>[t[o][0]],t([o])]]):Z(),44==G?tt(1):125!==G&&Z()}return tt(1),[t=>{const o={};for(const[e,n]of s)o[e[0](t)[0]]=n[0](t)[0];return[o]},t(...s.map(t=>[t[0][1],t[1][1]]).flat())]},ht=t=>{const s=new Map;return o=>s.has(o)?s.get(o):s.set(o,t(o)).get(o)},at=s=>{const o=s.split(/{{(.*?)}}/s);if(o.length<2)return null;const e=[];let n=!1,c=t();for(const s of o){if(n){const o=dt.js(s);e.push(o[0]),c=t(c,o[1])}else e.push(s);n=!n}return[e,c]},ut=t=>t?[(...s)=>t[0].map(t=>p(t?.call?t(...s):t)).join(""),t[1]]:null,dt={attr:ht(t=>{const s=at(t),o=s?.[0];return 3==o?.length&&""==o[0]&&""==o[2]?[(...t)=>{const s=o[1](...t);return"boolean"==typeof s?s:p(s)},s[1]]:ut(s)}),js:ht(t=>{D=t,F=-1,tt(1);let s=B();try{J&&(s=st()||Z()),J&&(s=B(),Z())}catch(t){}return[(...t)=>s[0](new Proxy({},{get(s,o){for(const s of t)if(o in s)return[s[o],s];return[C[o],C]}}))[0],s[1]]}),text:ht(t=>ut(at(t)))},pt={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:(t,s)=>t.target!==s,outside:(t,s)=>s.contains(t.target),ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>0!==t.button,middle:t=>1!==t.button,right:t=>2!==t.button,exact:(t,s,o)=>["ctrl","shift","alt","meta"].some(s=>t[`${s}Key`]&&!o.has(s))},mt=(t,s,o)=>{if(t?.[e]){const e=t[s];e!==o&&(t[s]=o,r(t,"change",s,e,o))}},$t={"*for":(t,s,o,e)=>{let n="key",c="value";const r=e.match(/^\s*(?:(?:(\S+)\s*,\s*)?(\S+)\s+of\s+)?(\S+)\s*$/);r&&(n=r[1]||n,c=r[2]||c,e=r[3]);const i=dt.js(e),l=j(s);let f=new Map;const h=()=>{const e=i[0](l,t)||[];let r=f;f=new Map;let h=s;for(const[s,i]of g(e)){let e=r.get(s);if(r.delete(s),e===h.nextSibling){j(e)[c]=i}else{e&&(St(t,e),e.remove()),e=v(o);const r=I(l,e);r[n]=s,r[c]=i,Ct(t,e),h.after(e)}h=e,f.set(s,h)}for(const s of r.values())St(t,s),s.remove()};H(t,s,h,i[1],l),h()},"*if":(t,s,o,e)=>{const n=dt.js(e),c=j(s);let r=null;const i=()=>{n[0](c,t)?r||(r=v(o),I(c,r),Ct(t,r),s.after(r)):r&&(St(t,r),r.remove(),r=null)};H(t,s,i,n[1],c),i()},"*repeat":(t,s,o,e)=>{let n="index";const c=e.match(/^(\S+)\s+as\s+(\S+)$/);c&&(e=c[1],n=c[2]);const r=dt.js(e),i=j(s);let l=[];const f=()=>{let e=+r[0](i,t);for(;l.length>e;){const s=l.pop();St(t,s),s.remove()}let c=l.length+1,f=l[c-1]||s;for(;l.length<e;){let s=v(o);I(i,s)[n]=c++,Ct(t,s),l.push(s),f.after(s),f=s}};H(t,s,f,r[1],i),f()}},wt={"":(t,s,o,e)=>{const n=dt.attr(o);if(n){const o=j(s),c=()=>{b(s,e,n[0](o,t))};H(t,s,c,n[1],o),c()}},"@":(s,o,e,n)=>{const[c,...r]=u(n.slice(1)).split("."),i=a.create(j(o)),l=dt.js(e),f={},h=t(r),p=t=>h.has(t)&&(h.delete(t),1);let m=o;for(const t of["passive","capture","once"])p(t)&&(f[t]=!0);p("window")&&(m=C),(p("document")||h.has("outside"))&&(m=k),m.addEventListener(c,t=>{[...h].some(s=>(pt[s]||(t=>{return o=t.key,d(o.replace(/^\p{Lu}/gu,t=>t.toLowerCase()))!==(s.match(/^code-\d+$/)?String.fromCodePoint(+s.split("-")[1]):s);var o}))(t,o,h))||(t=>{i.$event=t,l[0](i,s)})(t)},f),b(o,n)},"#class":(t,s,o,e)=>{const n=dt.js(o),c=j(s),r=()=>{for(const[o,e]of g(n[0](c,t)))_(s,o,!!e)};H(t,s,r,n[1],c),r(),b(s,e)},"#ref":(t,s,o,e)=>{const n=u(o);mt(t,n,s),b(s,e)},".":(t,s,o,e)=>{const n=dt.js(o),c=u(e.slice(1)),r=j(s),i=()=>{const o=n[0](r,t);s[c]=o};H(t,s,i,n[1],r),i(),b(s,e)}},bt=(t,s)=>("*"==t.charAt(0)?$t:wt)[t]=s,gt=(t,s)=>{for(const o of[...s.attributes]){const e=o.nodeName,n=e.charAt(0),c=wt[e]||wt[n]||wt[""];c?.(t,s,o.nodeValue||"",e)}},yt=(t,s,o)=>{const e=o.attributes;if(e){let r;for(const[t,s]of g($t)){const o=e.getNamedItem(t);o&&(r&&K(`${r[0]} breaks ${t}`),r=[t,s,o.nodeValue||""])}if(r){const e=(n=`${r[0]}=${c=r[2],JSON.stringify(c)}`,k.createComment(n));return o.before(e),s.previousNode(),o.remove(),s.nextNode(),b(o,r[0]),r[1](t,e,o,r[2],r[0]),s.previousNode(),1}}var n,c},kt=(t,s)=>{const o=dt.text(s.textContent||"");if(o){const e=j(s),n=()=>{s.nodeValue=o[0](e,t)};return H(t,s,n,o[1],e),n(),1}},Ct=(t,s)=>{const o=L();o.append(s),vt(t,o)},vt=(t,s)=>{const o=M(s,133);let e;for(;e=o.nextNode();){y(e)&&vt(t,e.content);const s=e.nodeType;3==s?kt(t,e):1==s&&(yt(t,o,e)||gt(t,e))}},St=(t,s)=>{r(t,"unlink",s)},Lt=T(),Et="DOMContentLoaded",Mt=(s,o,e)=>{const n=()=>{e(!0)};s.addEventListener(Et,n);const c=o.getRootNode(),r=Lt(c)||Lt(c,{s:t()}),i=()=>{e(!1)};return r.s.add(i),r.o||(r.o=new MutationObserver(()=>{for(const t of[...r.s])t()}),r.o.observe(c,{childList:!0,subtree:!0})),()=>{r.s.delete(i),s.removeEventListener(Et,n),r.s.size||(r.o.disconnect(),delete r.o)}},xt=(t,s)=>o=>_t(t,s,o),_t=(i,l,f)=>{const h=`fudgel_${i}`,a=Ot(l.style||"",i,h,l.useShadow);f=f||class{};const p=E(),C=t=>{const s=M(t.content,1);let o;for(;o=s.nextNode();)y(o)&&C(o),_(o,h,!0)};p.innerHTML=l.template,C(p);const v={...l,attr:t(l.attr||[]),cssClassName:h,prop:t(l.prop||[]),style:a,tag:i,template:p.innerHTML};class L extends HTMLElement{static{this.observedAttributes=[...v.attr].map(d)}attributeChangedCallback(t,s,o){mt(this[e],u(t),o)}connectedCallback(){const t=v.useShadow?this.shadowRoot||this.attachShadow({mode:"open"}):this,s={...v,events:new n,host:this,root:t,tagName:i},c=new f(s);this[e]=c,c[e]=s,o.add(c),_(this,h,!0);for(const t of v.attr){const s=d(t);mt(c,t,$(this,s)),A(c,t,t=>{(m(t)||null===t)&&c[e]&&b(this,s,t)})}for(const t of v.prop)w(this,t)&&mt(c,t,this[t]),A(this,t,s=>mt(c,t,s)),A(c,t,s=>this[t]=s),this[t]=c[t];r(c,"init"),((t,s,o)=>{const e=t.ownerDocument,n=()=>{let s=t;do{if(s.nextSibling)return!0}while(s=s.parentNode)};if(s!=t||"loading"!=e.readyState||n())o();else{const s=Mt(e,t,t=>{(t||n())&&(s(),o(!0))})}})(this,t,s=>{if(c[e]){r(c,"parse",s);const e=E();e.innerHTML=v.template,vt(c,e.content),t.innerHTML="";const n=t.getRootNode();if(v.style&&!n.querySelector("style."+h)){const t=S("style");_(t,h,!0),t.prepend((o=v.style,k.createTextNode(o))),(n.body||n).prepend(t)}t.append(e.content),r(c,"viewInit",s)}var o})}disconnectedCallback(){const t=this[e];r(t,"destroy"),o.delete(t),(t=>{for(const[s,o]of g(O(t)||{}))o.length=0})(this),delete t[e],delete this[e]}}try{customElements.define(i,L);const t=[L,f,v];s.add(t),c.emit("component",...t)}catch(t){}return L},Tt=(t,s,o,e)=>{t.selectorText&&(t.selectorText=t.selectorText.split(",").map(t=>{const n=t=>`${t}.${o}`,c=(t,s)=>t.replace(/:host/,s),r=c(t=t.trim(),"")==t;return e?(r||t.includes(" "))&&(t=n(t)):(t=c(t,s),r&&(t=`${s} ${n(t)}`)),t}).join(","),s="");for(const n of t.cssRules??[])Tt(n,s,o,e);return t.cssText},Ot=(t,s,o,e)=>[...x(t)].map(t=>Tt(t,s,o,e)).join(""),At=new Map,Ht=[],Nt=t=>{Ht.includes(t)&&(Ht.push(t),K(`Circular dependency: ${Ht.map(t=>`${t.name}`).join(" -> ")}`)),Ht.push(t);const s=At.get(t)||At.set(t,new t).get(t);return Ht.pop(),s},Pt=(t,s)=>{At.set(t,s)};class jt extends HTMLElement{constructor(){super(),this.l=L(),this.h=[],this.u=[],this.p=[];let t=this.children,s=t[0];if(y(s))this.u=Array.from(s.content.children);else for(;t.length>0;){const s=t[0];this.u.push(s),this.l.append(s)}}connectedCallback(){this.m(C,"popstate",this.$),this.m(k.body,"click",this.k),this.C(C.location.pathname),this.S(C.history,"pushState",this.L),this.S(C.history,"replaceState",this.L)}disconnectedCallback(){for(;this.p.length;)this.p.pop()()}go(t){C.history.pushState(null,"",t)}M(t){let s=!1;if(t.e!==this.h[0]){const o=$(t.e,"title"),e=$(t.e,"component");this.innerHTML="",o&&(k.title=o),this.h=[t.e,e?S(e):v(t.e)],s=!0}const o=this.h[1];for(const[s,e]of t.g)b(o,d(s),e);s&&this.append(o)}k(t){if(!t.defaultPrevented){const s=t.composedPath().filter(t=>"A"==t.tagName)[0];s&&s.href&&s.origin==C.location.origin&&!s.href.startsWith("blob:")&&(t.preventDefault(),this.go(`${s.pathname}${s.search}${s.hash}`))}}m(t,s,o){const e=o.bind(this);t.addEventListener(s,e),this.p.push(()=>t.removeEventListener(s,e))}_(t){for(const s of this.u){const o=$(s,"path")||"**",e=$(s,"regexp");let n=o;m(e)||(n=o.replace(/\*+/g,t=>t.length>1?".*":"[^/]*").replace(/:[^:\/]+/g,t=>`(?<${t.slice(1)}>[^/]+)`));const c=new RegExp(`^${n}(/.*)?$`),r=t.match(c);if(r)return{e:s,g:g(r.groups||{})}}}L(t,s){return(o,e,n)=>{s.call(t,o,e,n),this.C(n||"/")}}S(t,s,o){const e=t[s];t[s]=o.call(this,t,e),this.p.push(()=>t[s]=e)}$(){this.C(C.location.pathname)}C(t){const s=this._(t);s&&this.M(s),i(k.body,"routeChange",t)}}const It=(t="router-outlet")=>{customElements.define(t,jt)},Kt=T(),Dt=(t,s)=>t.n[s]||(t.n[s]=L()),Ft=t=>t.parentElement||(t.getRootNode()||{}).host,Gt=t(),Jt=(t="slot-like")=>{class o extends HTMLElement{constructor(){super();let t=Ft(this);for(;t&&!(this.T=Kt(t));)t=Ft(t)}attributeChangedCallback(t,s,o){const e=this.T;e&&s!==o&&(this.O(e,s),this.A(e))}connectedCallback(){const t=this.T;t&&(I(t.s,this),this.A(t))}disconnectedCallback(){this.T&&this.O(this.T,$(this,"name")||"")}A(t){const s=$(this,"name")||"";this.append(t.n[s]||[]),this.H=t.e.on(s,()=>{this.O(t,s),this.A(t)})}O(t,s){this.H(),Dt(t,s).append(...this.childNodes),t.e.emit(s)}}o.observedAttributes=["name"],customElements.define(t,o),c.on("init",t=>{if(Gt.has(t.constructor)){const{root:s,host:o,events:c}=t[e];c.on("parse",()=>{const t=s.innerHTML;c.on("destroy",()=>s.innerHTML=t);const e=Kt(s,{e:new n,n:{"":L()},s:j(Ft(o))});for(const t of[...s.querySelectorAll("[slot]")])Dt(e,$(t,"slot")||"").append(t);for(const t of[...s.childNodes])e.n[""].append(t)})}});const r=(s,o,e)=>{if(!e.useShadow){let s=!1,n=!1;const c=E();c.innerHTML=e.template;const r=M(c.content,1);let i;for(;i=r.nextNode();)if("SLOT"==i.nodeName){s=!0;const o=S(t);for(const t of i.attributes)b(o,t.name,t.value);r.previousNode(),o.append(...i.childNodes),i.replaceWith(o)}else"SLOT-LIKE"==i.nodeName&&(n=!0);s&&(e.template=c.innerHTML),(s||n)&&Gt.add(o)}};for(const t of s)r(...t);c.on("component",r)},Rt=(t,...s)=>String.raw({raw:t},...s),Wt=Rt;export{xt as Component,n as Emitter,jt as RouterComponent,bt as addDirective,s as allComponents,_t as component,Rt as css,It as defineRouterComponent,Jt as defineSlotComponent,Nt as di,Pt as diOverride,l as emit,c as events,$ as getAttribute,j as getScope,Wt as html,Ct as link,vt as linkNodes,e as metadata,dt as parse,b as setAttribute,St as unlink,f as update};