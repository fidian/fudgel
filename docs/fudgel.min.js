const t=()=>{const t=new WeakMap;return(e,n)=>t.get(e)||n&&t.set(e,n).get(e)},e=t(),n=t(),o=new Map,s=t(),c=t(),r=t(),a=t(),l=t(),i=t(),f=(t,e,...n)=>{const o=s(e);if(o)for(const s of o[t]||[])o[t].includes(s)&&s(e,...n)},p=t=>{const e=[t];let n;for(;n=e.shift();){for(const t of r(n,[]))t();for(const t of n.childNodes)e.push(t)}},u=(t,e,n,o)=>{const c=s(t,{});c[n]?c[n].push(o):c[n]=[o];r(e,[]).push((()=>{const e=s(t);e&&e[n]&&(e[n]=e[n].filter((t=>t!==o)))}))},d=(t,e,n,s={})=>{const c=o.get(t);c&&c.dispatchEvent(new CustomEvent(e,Object.assign({bubbles:!0,cancelable:!1,composed:!0,detail:n},s)))},h=(t,e)=>{if(t)f(`set:${e||""}`,t);else for(const t of o.keys())f("set:",t)},g=t=>JSON.stringify(t),w=t=>{const e={};return(...n)=>{const o=g(n);return e[o]||(e[o]=t(...n))}},m=w(((t,e)=>new Function(t,e))),b=t=>m("$scope",`return ${t}`),$=t=>t.replace(/-(\w)/g,(t=>t[1].toUpperCase())),v=(t,e,n)=>{!0===n&&(n=""),"string"!=typeof n?t.removeAttribute(e):t.setAttribute(e,`${n}`)},y=(t,e,n)=>{const o=a(t,{});let s=o[e];if(!s){let n=t[e];const c=Object.getOwnPropertyDescriptor(t,e)||{};s=[],o[e]=s,Object.defineProperty(t,e,{get:c.get||(()=>n),set:function(t){const e=n;if(t!==e){c.set?c.set(t):n=t;for(const n of s)n(this,t,e)}}})}s.push(n)},C=(t,e)=>{"function"==typeof t&&(t=t.prototype),l(t,[]).push(e)},N=()=>S,M=(t,e)=>S(t.constructor.prototype,e),S=(t,e)=>C(t,(t=>{u(t,o.get(t),"init",(t=>{const n=e.replace(/\p{Lu}/g,(t=>`-${t[0]}`.toLowerCase()));const s=o.get(t);if(s){const o=(t,n,o)=>{t[e]=o,t.onChange&&t.onChange(e,n,o)};u(t,s,`attr:${n}`,o),o(t,null,s.getAttribute(n))}y(t,e,((t,e)=>{const s=o.get(t);s&&v(s,n,e)}))}))})),T=document,E=window,L=t=>T.createElement(t),O=t=>{const e=L("style");return e.appendChild((t=>T.createTextNode(t))(t)),e};function j(t,e,n,o){u(t,e,"set:",n);for(const s of o){const o=`set:${s}`;y(t,s,((t,e,n)=>{f(o,t,e,n),t.onChange&&t.onChange(s,e,n)})),u(t,e,o,n)}}const x=t=>{let e=i(t),n=t.parentNode;for(;!e&&n;)e=i(n),n=n.parentNode;return e||{}},k=(t,e)=>{const n=Object.create(t);return i(e,n),n},A=w((t=>{const e=t.split(/{{(.*?)}}/);if(e.length<2)return null;const n=[];let o=!1;const s=new Set;for(const t of e){if(o){n.push(b(t));for(const e of V(t))s.add(e)}else n.push(t);o=!o}return{fn:function(t){return n.map((e=>{return e=e&&e.call?e.call(this,t):e,null==(n=e)?"":`${n}`;var n})).join("")},binds:s}})),D=/this\.((?:\$|_|\p{L}|\p{Nl})(?:\$|_|\p{L}|\p{Nl}|\u200C|\u200D|\p{Mn}|\p{Mc}|\p{Nd})*)/u,V=w((t=>{const e=new Set,n=t.split(D);for(let t=1;t<n.length;t+=2)e.add(n[t]);return e})),I=[{"*for":(t,e,n,o)=>{let s="key",c="value";const r=o.match(/^\s*(?:(?:(\S+)\s*,\s*)?(\S+)\s+of\s+)?(\S+)\s*$/);r&&(s=r[1]||s,c=r[2]||c,o=r[3]);const a=b(o),l=x(e);let i=new Map;const f=t=>{const o=a.call(t,l)||[];let r=i;i=new Map;let f=e;const u=()=>o.entries?o.entries():Object.entries(o),d=new Map(r);for(const[t]of u())d.delete(t);for(const t of d.values())p(t),t.remove(),r.delete(t);for(const[e,o]of u()){let a=r.get(e);if(r.delete(e),a!==f.nextSibling){a&&(p(a),a.remove()),a=n.cloneNode(!0);const r=k(l,a);r[s]=e,r[c]=o,_(a,t),f.after(a)}else{k(l,a)[c]=o}f=a,i.set(e,f)}for(const t of r.values())p(t),t.remove()};j(t,e,f,V(o)),f(t)},"*if":(t,e,n,o)=>{const s=b(o),c=x(e);let r=null;const a=t=>{s.call(t,c)?r||(r=n.cloneNode(!0),_(r,t),e.after(r)):r&&(p(r),r.remove(),r=null)};j(t,e,a,V(o)),a(t)},"*repeat":(t,e,n,o)=>{let s="index";const c=o.match(/^(\S+)\s+as\s+(\S+)$/);c&&(o=c[1],s=c[2]);const r=b(o),a=x(e);let l=[];const i=t=>{let o=+r.call(t,a);for(;l.length>o;){const t=l.pop();p(t),t.remove()}let c=l.length+1,i=l[c-1]||e;for(;l.length<o;){let e=n.cloneNode(!0);k(a,e)[s]=c++,_(e,t),l.push(e),i.after(e),i=e}};j(t,e,i,V(o)),i(t)}},{"":(t,e,n,o)=>{const s=A(n);if(s){const n=t=>{const n=s.fn.call(t,x(e));v(e,o,n)};j(t,e,n,s.binds),n(t)}},"@":(t,e,n,o)=>{const[s,...c]=$(o.slice(1)).split("."),r=x(e),a=m("s,e",`(($scope,$event)=>{${n}})(s,e)`),l={},i=new Set(c);let f=e;for(const t of["passive","capture","once"])i.has(t)&&(l[t]=!0);i.has("window")&&(f=E),(i.has("document")||i.has("outside"))&&(f=T),f.addEventListener(s,(n=>{i.has("prevent")&&n.preventDefault(),i.has("stop")&&n.stopPropagation();const o=n.target;i.has("self")&&o!==e||i.has("outside")&&e.contains(o)||a.call(t,r,n)}),l),v(e,o)},"#ref":(t,e,n,o)=>{t[$(n)]=e,v(e,o)},".":(t,e,n,o)=>{const s=b(n),c=$(o.slice(1)),r=x(e),a=t=>{const n=s.call(t,r);e[c]=n};j(t,e,a,V(n)),a(t),v(e,o)}}],P=(t,e)=>I["*"===t.charAt(0)?0:1][t]=e;function H(t,e){if(1===e.nodeType){for(const n of[...e.attributes]){const o=n.nodeName,s=o.charAt(0),c=I[1],r=c[o]||c[s]||c[""];r&&r(t,e,n.nodeValue||"",o)}const n=A(e.textContent||"");if(n){const o=t=>{e.nodeValue=n.fn.call(t,x(e))};j(t,e,o,n.binds),o(t)}}return 1}const R=(t,e,n)=>{const o=n.attributes;if(1===n.nodeType&&o){let c;for(const[t,e]of Object.entries(I[0])){const n=o.getNamedItem(t);if(n){if(c)throw new Error(`${c[0]} breaks ${t}`);c=[t,e,n.nodeValue||""]}}if(c){const o=(s=`${c[0]}=${g(c[2])}`,T.createComment(s));return n.before(o),e.previousNode(),n.remove(),v(n,c[0]),c[1](t,o,n,c[2],c[0]),1}}var s};function F(t,e){if(3===e.nodeType){const n=A(e.textContent||"");if(n){const o=t=>{e.nodeValue=n.fn.call(t,x(e))};return j(t,e,o,n.binds),o(t),1}}}const W=(t,e)=>{const n=T.createTreeWalker(t,133);let o;for(;o=n.nextNode();)"TEMPLATE"===o.nodeName&&W(o.content,e),R(e,n,o)||F(e,o)||H(e,o)},_=(t,e)=>{const n=T.createDocumentFragment();n.append(t),W(n,e)};class J extends HTMLElement{constructor(){super(),i(this,{})}attributeChangedCallback(t,e,n){const o=c(this);f(`attr:${t}`,o,e,n)}connectedCallback(){const t=this.constructor,s=new(n(t));c(this,s),o.set(s,this),(t=>{let e=t.constructor.prototype;for(;e;){for(const n of l(e)||[])n(t);n=e,e=Object.getPrototypeOf(n)}var n})(s);const r=e(t),a=this.shadowRoot||this.attachShadow({mode:"open"});r.style&&a.appendChild(O(r.style)),s.onInit&&s.onInit(),f("init",s);const i=r.template,p=L("template");p.innerHTML=i,W(p.content,s),a.append(p.content),s.onViewInit&&s.onViewInit()}disconnectedCallback(){const t=c(this);p(this),o.delete(t),this.innerHTML="",this.shadowRoot&&(this.shadowRoot.innerHTML=""),t&&t.onDestroy&&t.onDestroy()}}const U=(t,e)=>n=>{z(t,e,n)},q=customElements,z=(t,o,s)=>{const c=class extends J{};e(c,o),n(c,s||class{}),q.get(t)||q.define(t,c)},B=new Map,G=[],K=t=>{if(G.includes(t))throw G.push(t),new Error(`Circular dependency: ${G.map((t=>`${t.name}`)).join(" -> ")}`);G.push(t);const e=B.get(t)||B.set(t,new t).get(t);return G.pop(),e},Q=(t,e)=>{B.set(t,e)},X=()=>Z,Y=(t,e)=>Z(t.constructor.prototype,e),Z=(t,e)=>{C(t,(t=>{u(t,o.get(t),"init",(t=>{const n=o.get(t);if(n){const t=(t,n)=>{c(t)[e]=n};y(n,e,t),t(n,n[e])}}))}))},tt=(t,...e)=>String.raw({raw:t},...e),et=tt;export{N as Attr,U as Component,J as CustomElement,X as Prop,P as addDirective,M as attr,z as component,et as css,K as di,Q as diOverride,d as emit,V as findBindings,tt as html,o as metadataControllerElement,A as parseText,Y as prop,B as registered,h as update};