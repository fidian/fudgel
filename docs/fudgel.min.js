const t=[{},{}],e=(e,n)=>t["*"===e.charAt(0)?0:1][e]=n,n=()=>{const t=new WeakMap;return(e,n)=>t.get(e)||n&&t.set(e,n).get(e)},o=n(),s=n(),c=new Map,r=n(),l=n(),i=n(),a=n(),f=n(),p=n(),u=n(),d=n(),h=(t,e,...n)=>{const o=r(e);if(o)for(const s of o[t]||[])o[t].includes(s)&&s(e,...n)},g=t=>{const e=[t];let n;for(;n=e.shift();){for(const t of p(n,[]))t();for(const t of n.childNodes)e.push(t)}},b=(t,e,n,o)=>{const s=r(t,{});s[n]?s[n].push(o):s[n]=[o];p(e,[]).push((()=>{const e=r(t);e&&e[n]&&(e[n]=e[n].filter((t=>t!==o)))}))},m=(t,e,n,o)=>{const s=t(e,{});if(!s[n]){s[n]=1;let t=e[n];const c=Object.getOwnPropertyDescriptor(e,n)||{};Object.defineProperty(e,n,{get:c.get||(()=>t),set:function(e){const n=t;e!==n&&(c.set?c.set(e):t=e,o(this,e,n))}})}};function y(t,e,n,o){b(t,e,"set:",n);for(const s of o){const o=`set:${s}`;m(i,t,s,((t,e,n)=>{h(o,t,e,n),t.onChange&&t.onChange(s,e,n)})),b(t,e,o,n)}}const $=t=>{let e=d(t),n=t.parentNode;for(;!e&&n;)e=d(n),n=n.parentNode;return e||{}},v=(t,e)=>{const n=Object.create(t);return d(e,n),n},w=t=>JSON.stringify(t),C=t=>{const e={};return(...n)=>{const o=w(n);return e[o]||(e[o]=t(...n))}},N=C(((t,e)=>new Function(t,e))),M=t=>N("$scope",`return ${t}`),L=t=>t.replace(/-\p{Ll}/gu,(t=>t[1].toUpperCase())),O=(t,e,n)=>{!0===n&&(n=""),"string"!=typeof n?t.removeAttribute(e):t.setAttribute(e,`${n}`)},S=C((t=>{const e=t.split(/{{(.*?)}}/);if(e.length<2)return null;const n=[];let o=!1;const s=new Set;for(const t of e){if(o){n.push(M(t));for(const e of T(t))s.add(e)}else n.push(t);o=!o}return{fn:function(t){return n.map((e=>{return e=e&&e.call?e.call(this,t):e,null==(n=e)?"":`${n}`;var n})).join("")},binds:s}})),x=/this\.((?:\$|_|\p{L}|\p{Nl})(?:\$|_|\p{L}|\p{Nl}|\u200C|\u200D|\p{Mn}|\p{Mc}|\p{Nd})*)/u,T=C((t=>{const e=new Set,n=t.split(x);for(let t=1;t<n.length;t+=2)e.add(n[t]);return e})),j=document,k=t=>j.createElement(t),E=t=>{const e=k("style");return e.appendChild((t=>j.createTextNode(t))(t)),e},D=()=>j.createDocumentFragment();function V(e,n){if(1===n.nodeType){for(const o of[...n.attributes]){const s=o.nodeName,c=s.charAt(0),r=t[1],l=r[s]||r[c]||r[""];l&&l(e,n,o.nodeValue||"",s)}const o=S(n.textContent||"");if(o){const t=t=>{n.nodeValue=o.fn.call(t,$(n))};y(e,n,t,o.binds),t(e)}}return 1}const A=(e,n,o)=>{const s=o.attributes;if(1===o.nodeType&&s){let r;for(const[e,n]of Object.entries(t[0])){const t=s.getNamedItem(e);if(t){if(r)throw new Error(`${r[0]} breaks ${e}`);r=[e,n,t.nodeValue||""]}}if(r){const t=(c=`${r[0]}=${w(r[2])}`,j.createComment(c));return o.before(t),n.previousNode(),o.remove(),O(o,r[0]),r[1](e,t,o,r[2],r[0]),1}}var c};function I(t,e){if(3===e.nodeType){const n=S(e.textContent||"");if(n){const o=t=>{e.nodeValue=n.fn.call(t,$(e))};return y(t,e,o,n.binds),o(t),1}}}const H=(t,e)=>{const n=j.createTreeWalker(t,133);let o;for(;o=n.nextNode();)A(e,n,o)||I(e,o)||V(e,o)},P=(t,e,n,o={})=>{const s=c.get(t);s&&s.dispatchEvent(new CustomEvent(e,Object.assign({bubbles:!0,cancelable:!1,composed:!0,detail:n},o)))},F=(t,e)=>{if(t)h(`set:${e||""}`,t);else for(const t of c.keys())h("set:",t)},R=(t,e)=>{"function"==typeof t&&(t=t.prototype),u(t,[]).push(e)},W=()=>J,_=(t,e)=>J(t.constructor.prototype,e),J=(t,e)=>R(t,(t=>{b(t,c.get(t),"init",(t=>{const n=e.replace(/\p{Lu}/gu,(t=>`-${t[1]}`.toLowerCase()));const o=c.get(t);if(o){const s=(t,n,o)=>{t[e]=o,t.onChange&&t.onChange(e,n,o)};b(t,o,`attr:${n}`,s),s(t,null,o.getAttribute(e))}const s=(t,e)=>{const o=c.get(t);o&&O(o,n,e)};m(l,t,e,s),s(t,t[e])}))}));class U extends HTMLElement{constructor(){super(),d(this,{})}attributeChangedCallback(t,e,n){const o=a(this);h(`attr:${t}`,o,e,n)}connectedCallback(){const t=this.constructor,e=new(s(t));a(this,e),c.set(e,this),(t=>{let e=t.constructor.prototype;for(;e;){for(const n of u(e)||[])n(t);n=e,e=Object.getPrototypeOf(n)}var n})(e);const n=o(t),r=this.shadowRoot||this.attachShadow({mode:"open"});n.style&&r.appendChild(E(n.style)),e.onInit&&e.onInit(),h("init",e);const l=n.template,i=k("template");i.innerHTML=l,H(i.content,e),r.append(i.content),e.onViewInit&&e.onViewInit()}disconnectedCallback(){const t=a(this);g(this),c.delete(t),this.innerHTML="",this.shadowRoot.innerHTML="",t.onDestroy&&t.onDestroy()}}const q=(t,e)=>n=>{B(t,e,n)},z=customElements,B=(t,e,n)=>{const c=class extends U{};o(c,e),s(c,n||class{}),z.get(t)||z.define(t,c)},G=()=>Q,K=(t,e)=>Q(t.constructor.prototype,e),Q=(t,e)=>{R(t,(t=>{b(t,c.get(t),"init",(t=>{const n=c.get(t);if(n){const t=(t,n)=>{a(t)[e]=n};m(f,n,e,t),t(n,n[e])}}))}))};e("",((t,e,n,o)=>{const s=S(n);if(s){const n=t=>{const n=s.fn.call(t,$(e));O(e,o,n)};y(t,e,n,s.binds),n(t)}})),e("@",((t,e,n,o)=>{const s=L(o.slice(1)),c=$(e),r=N("s,e",`!1===(($scope,$event)=>{${n}})(s,e)&&(e.preventDefault(),e.stopPropagation())`);e.addEventListener(s,(e=>r.call(t,c,e))),O(e,o)})),e("#ref",((t,e,n,o)=>{t[L(n)]=e,O(e,o)})),e(".",((t,e,n,o)=>{const s=M(n),c=L(o.slice(1)),r=$(e),l=t=>{const n=s.call(t,r);e[c]=n};y(t,e,l,T(n)),l(t),O(e,o)})),e("*for",((t,e,n,o)=>{let s="key",c="value";const r=o.match(/^\s*(?:(?:(\S+)\s*,\s*)?(\S+)\s+of\s+)?(\S+)\s*$/);r&&(s=r[1]||s,c=r[2]||c,o=r[3]);const l=M(o),i=$(e);let a=new Map;const f=t=>{const o=l.call(t,i)||[];let r=a;a=new Map;let f=e;const p=()=>o.entries?o.entries():Object.entries(o),u=new Map(r);for(const[t]of p())u.delete(t);for(const t of u.values())g(t),t.remove(),r.delete(t);for(const[e,o]of p()){let l=r.get(e);if(r.delete(e),l!==f.nextSibling){l&&(g(l),l.remove()),l=n.cloneNode(!0);const r=v(i,l);r[s]=e,r[c]=o;const a=D();a.append(l),H(a,t),f.after(l)}else{v(i,l)[c]=o}f=l,a.set(e,f)}for(const t of r.values())g(t),t.remove()};y(t,e,f,T(o)),f(t)})),e("*if",((t,e,n,o)=>{const s=M(o),c=$(e);let r=null;const l=t=>{if(s.call(t,c)){if(!r){r=n.cloneNode(!0);const o=D();o.append(r),H(o,t),e.after(r)}}else r&&(g(r),r.remove(),r=null)};y(t,e,l,T(o)),l(t)})),e("*repeat",((t,e,n,o)=>{let s="index";const c=o.match(/^(\S+)\s+as\s+(\S+)$/);c&&(o=c[1],s=c[2]);const r=M(o),l=$(e);let i=[];const a=t=>{let o=+r.call(t,l);for(;i.length>o;){const t=i.pop();g(t),t.remove()}let c=i.length+1,a=i[c-1]||e;for(;i.length<o;){const e=D();let o=n.cloneNode(!0);v(l,o)[s]=c++,e.append(o),H(e,t),i.push(o),a.after(o),a=o}};y(t,e,a,T(o)),a(t)}));export{W as Attr,q as Component,U as CustomElement,G as Prop,e as addDirective,_ as attr,B as component,P as emit,T as findBindings,c as metadataControllerElement,S as parseText,K as prop,F as update};