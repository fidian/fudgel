const t=(...t)=>new Set(t.flatMap(t=>[...t])),s=t(),o=t(),e=Symbol();class n{constructor(){this.i=new Map}emit(t,...s){for(const o of[...this.i.get(t)??[]])o(...s)}off(t,s){const o=this.i.get(t)?.filter(t=>t!==s);o?this.i.set(t,o):this.i.delete(t)}on(t,s){return(this.i.get(t)??this.i.set(t,[]).get(t)).push(s),()=>this.off(t,s)}}const c=new n,r=(t,s,...o)=>{c.emit(s,t,...o),t[e]?.events.emit(s,...o),t[`on${s[0].toUpperCase()}${s.slice(1)}`]?.(...o)},i=(t,s,o,n={})=>{const c=t instanceof Element?t:t[e]?.host;c&&c.dispatchEvent(new CustomEvent(s,{bubbles:!0,cancelable:!1,composed:!0,detail:o,...n}))},l=t=>{if(t)f(t);else for(const t of o)f(t)},f=s=>{const{attr:o,prop:n}=s[e];for(const e of t(n,o))r(s,"change",e,s[e],s[e]);s[e]?.events.emit("update")},h=Object,a=t=>t.replace(/-(\p{Ll})/gu,t=>t[1].toUpperCase()),u=t=>t.replace(/\p{Lu}/gu,t=>`-${t[0]}`.toLowerCase()),d=t=>`${t??""}`,p=t=>"string"==typeof t,m=(t,s)=>t.getAttribute(s),$=(t,s)=>h.prototype.hasOwnProperty.call(t,s),w=(t,s,o)=>{!0===o&&(o=""),p(o)?t.setAttribute(s,o):t.removeAttribute(s)},g=t=>t.entries?.()??h.entries(t),b=t=>"TEMPLATE"==t.nodeName,y=document,k=window,C=t=>t.cloneNode(!0),v=t=>y.createElement(t),S=()=>y.createDocumentFragment(),E=()=>v("template"),L=(t,s)=>y.createTreeWalker(t,s),M=t=>{const s=y.implementation.createHTMLDocument(""),o=s.createElement("style");return o.textContent=t,s.body.append(o),o.sheet.cssRules||[]},x=(t,s,o)=>t.classList.toggle(s,o),_=()=>{const t=new WeakMap;return(s,o)=>(o?t.set(s,o):t).get(s)},T=_(),O=(t,s,o)=>{const e=T(t)||T(t,{});let n=e[s];if(!n){let o=t[s];const c=h.getOwnPropertyDescriptor(t,s)||{};n=[],e[s]=n,h.defineProperty(t,s,{get:c.get||(()=>o),set:function(t){const s=o;if(!h.is(t,s)){c.set?.(t),o=t;for(const o of n)o(t,s)}}})}n.push(o)},A=(t,s,o,n,c)=>{for(const r of n){const n=H(t,c,r);O(n,r,o);const i=()=>{for(const t of f)t?.()},l=t[e]?.events,f=[l?.on("update",o),l?.on("unlink",t=>{t.contains(s)&&i()}),l?.on("destroy",i)]}},H=(t,s,o)=>$(s,o)?s:$(s,e)?t:H(t,h.getPrototypeOf(s),o),N=_(),P=t=>{let s=N(t);if(t){let o=t.parentNode;for(;!s&&o;)s=N(o),o=o.parentNode}return s||N(y.body)||N(y.body,{[e]:!0})},j=(t,s)=>N(s,h.create(t)),I=t=>{const s=new Error(t);throw console.error(s),s};let K="",D=0,F=0,G=!1;const J={b:"\b",f:"\f",n:"\n",r:"\r",t:"\t",v:"\v"},R={"-":t=>s=>[-t(s)[0]],"!":t=>s=>[!t(s)[0]],"~":t=>s=>[~t(s)[0]],"+":t=>s=>[+t(s)[0]],typeof:t=>s=>[typeof t(s)[0]]},W={"||":[3,(t,s)=>o=>[t(o)[0]||s(o)[0]]],"??":[3,(t,s)=>o=>[t(o)[0]??s(o)[0]]],"&&":[4,(t,s)=>o=>[t(o)[0]&&s(o)[0]]],"|":[5,(t,s)=>o=>[t(o)[0]|s(o)[0]]],"^":[6,(t,s)=>o=>[t(o)[0]^s(o)[0]]],"&":[7,(t,s)=>o=>[t(o)[0]&s(o)[0]]],"===":[8,(t,s)=>o=>[t(o)[0]===s(o)[0]]],"==":[8,(t,s)=>o=>[t(o)[0]==s(o)[0]]],"!==":[8,(t,s)=>o=>[t(o)[0]!==s(o)[0]]],"!=":[8,(t,s)=>o=>[t(o)[0]!=s(o)[0]]],"<<":[10,(t,s)=>o=>[t(o)[0]<<s(o)[0]]],">>>":[10,(t,s)=>o=>[t(o)[0]>>>s(o)[0]]],">>":[10,(t,s)=>o=>[t(o)[0]>>s(o)[0]]],"<=":[9,(t,s)=>o=>[t(o)[0]<=s(o)[0]]],"<":[9,(t,s)=>o=>[t(o)[0]<s(o)[0]]],">=":[9,(t,s)=>o=>[t(o)[0]>=s(o)[0]]],">":[9,(t,s)=>o=>[t(o)[0]>s(o)[0]]],instanceof:[9,(t,s)=>o=>[t(o)[0]instanceof s(o)[0]]],in:[9,(t,s)=>o=>[t(o)[0]in s(o)[0]]],"+":[11,(t,s)=>o=>[t(o)[0]+s(o)[0]]],"-":[11,(t,s)=>o=>[t(o)[0]-s(o)[0]]],"**":[13,(t,s)=>o=>[t(o)[0]**s(o)[0]],1],"*":[12,(t,s)=>o=>[t(o)[0]*s(o)[0]]],"/":[12,(t,s)=>o=>[t(o)[0]/s(o)[0]]],"%":[12,(t,s)=>o=>[t(o)[0]%s(o)[0]]]},q={true:!0,false:!1,null:null,undefined:void 0},z=()=>[()=>[],t()],B=(t=1)=>{D+=t,F=K.charCodeAt(D),G=F>=0},Q=()=>K.charAt(D),U=(t=F)=>t>47&&t<58,V=(t=F)=>t>64&&t<91||t>96&&t<123||t>127||36==t||95==t,X=t=>V(t)||U(t),Y=()=>{I(`Parse error at index ${D}: ${K}`)},Z=(t=0)=>{for(t&&B(t);32==F||9==F||10==F||13==F;)B()},tt=()=>{const s=()=>{const s=n.pop(),o=n.pop(),e=n.pop();n.push([o[1](e[0],s[0]),t(e[1],s[1])])},o=ot();if(!o)return o;let e=st(W);if(!e)return o;const n=[o,e,ot()||Y()],c=t=>t[2]^e[0]<=t[0];for(;e=st(W);){for(;n.length>2&&c(n[n.length-2]);)s();n.push(e,ot()||Y())}for(;n.length>1;)s();return n[0]},st=t=>{for(const s of h.keys(t))if(!(K.substr(D,s.length)!=s||V()&&X(K.charCodeAt(D+s.length))))return Z(s.length),t[s]},ot=()=>{let s;if(U()||46==F)return nt();if(34==F||39==F){const o=ct();s=[()=>[o],t()]}else if(91===F)Z(1),s=it(93,!0);else if(123===F)s=lt();else{const o=st(R);if(o){const t=ot()||Y();return[o(t[0]),t[1]]}const e=rt();s=e in q?[()=>[q[e]],t()]:[t=>t[e],t([e])]}return et(s)},et=s=>{for(;46==F||91==F||40==F||63==F;){let o,e,n=t(),c=s;if(63==F){if(B(),46!==F)return B(-1),s;o=!0}if(91==F){Z(1);const t=tt()||Y();e=(s,o)=>[s[0][t[0](o)[0]],s[0]],n=t[1],93!==F&&Y(),Z(1)}else if(40==F){Z(1);const t=it(41);e=(s,o)=>[s[0].apply(s[1],t[0](o)[0])],n=t[1]}else if(46==F){Z(1);const t=rt();e=s=>[s[0][t],s[0]]}else Y();s=o?[t=>{const s=c[0](t);return null==s[0]?[]:e(s,t)},t(c[1],n)]:[t=>e(c[0](t),t),t(c[1],n)],Z()}return s},nt=()=>{let s="";for(;U();)s+=Q(),B();if(46==F)for(s+=".",B();U();)s+=Q(),B();if(101==F||69==F){s+=Q(),B(),43!=F&&45!=F||(s+=Q(),B()),U()||Y();do{s+=Q(),B()}while(U())}V()?Y():46!=F&&"."!=s||Y(),Z();const o=parseFloat(s);return[()=>[o],t()]},ct=()=>{let t="";const s=F;for(B();G&&F!=s;){if(92==F){B();const s=Q();t+=J[s]||s}else t+=Q();B()}return G||Y(),Z(1),t},rt=()=>{let t=D;for(V()||Y(),B();G&&X();)B();const s=K.slice(t,D);return Z(),s},it=(s,o)=>{const e=[];for(;F!==s;)G||Y(),e.push(o&&44==F?z():tt()),44==F?Z(1):F!==s&&Y();return Z(1),[t=>[e.map(s=>s[0](t)[0])],t(...e.map(t=>t[1]))]},lt=()=>{Z(1);const s=[];for(;125!==F;){let o,e;G||Y(),U()||46==F?e=nt():34==F||39==F?o=ct():91==F?(Z(1),e=tt(),93!=F&&Y(),Z(1)):o=rt(),o&&(e=[()=>[o],t()]),58==F?(Z(1),s.push([e,tt()])):o?s.push([e,[t=>[t[o][0]],t([o])]]):Y(),44==F?Z(1):125!==F&&Y()}return Z(1),[t=>{const o={};for(const[e,n]of s)o[e[0](t)[0]]=n[0](t)[0];return[o]},t(...s.map(t=>[t[0][1],t[1][1]]).flat())]},ft=t=>{const s=new Map;return o=>s.has(o)?s.get(o):s.set(o,t(o)).get(o)},ht=s=>{const o=s.split(/{{(.*?)}}/s);if(o.length<2)return null;const e=[];let n=!1,c=t();for(const s of o){if(n){const o=ut.js(s);e.push(o[0]),c=t(c,o[1])}else e.push(s);n=!n}return[e,c]},at=t=>t?[(...s)=>t[0].map(t=>d(t?.call?t(...s):t)).join(""),t[1]]:null,ut={attr:ft(t=>{const s=ht(t),o=s?.[0];return 3==o?.length&&""==o[0]&&""==o[2]?[(...t)=>{const s=o[1](...t)??!1;return s===!!s?s:d(s)},s[1]]:at(s)}),js:ft(t=>{K=t,D=-1,Z(1);let s=z();try{G&&(s=tt()||Y()),G&&(s=z(),Y())}catch(t){}return[(...t)=>s[0](new Proxy({},{get(s,o){for(const s of t)if(o in s)return[s[o],s];return[k[o],k]}}))[0],s[1]]}),text:ft(t=>at(ht(t)))},dt={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:(t,s)=>t.target!==s,outside:(t,s)=>s.contains(t.target),ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>0!==t.button,middle:t=>1!==t.button,right:t=>2!==t.button,exact:(t,s,o)=>["ctrl","shift","alt","meta"].some(s=>t[`${s}Key`]&&!o.has(s))},pt=(t,s,o)=>{if(t?.[e]){const e=t[s];e!==o&&(t[s]=o,r(t,"change",s,e,o))}},mt={"*for":(t,s,o,e)=>{let n="key",c="value";const r=e.match(/^\s*(?:(?:(\S+)\s*,\s*)?(\S+)\s+of\s+)?(\S+)\s*$/);r&&(n=r[1]||n,c=r[2]||c,e=r[3]);const i=ut.js(e),l=P(s);let f=new Map;const h=()=>{const e=i[0](l,t)||[];let r=f;f=new Map;let h=s;for(const[s,i]of g(e)){let e=r.get(s);if(r.delete(s),e===h.nextSibling){P(e)[c]=i}else{e&&(vt(t,e),e.remove()),e=C(o);const r=j(l,e);r[n]=s,r[c]=i,kt(t,e),h.after(e)}h=e,f.set(s,h)}for(const s of r.values())vt(t,s),s.remove()};A(t,s,h,i[1],l),h()},"*if":(t,s,o,e)=>{const n=ut.js(e),c=P(s);let r=null;const i=()=>{n[0](c,t)?r||(r=C(o),j(c,r),kt(t,r),s.after(r)):r&&(vt(t,r),r.remove(),r=null)};A(t,s,i,n[1],c),i()},"*repeat":(t,s,o,e)=>{let n="index";const c=e.match(/^(.*\S+)\s+as\s+(\S+)$/);c&&(e=c[1],n=c[2]);const r=ut.js(e),i=P(s);let l=[];const f=()=>{let e=+r[0](i,t);for(;l.length>e;){const s=l.pop();vt(t,s),s.remove()}let c=l.length+1,f=l[c-1]||s;for(;l.length<e;){let s=C(o);j(i,s)[n]=c++,kt(t,s),l.push(s),f.after(s),f=s}};A(t,s,f,r[1],i),f()}},$t={"":(t,s,o,e)=>{const n=ut.attr(o);if(n){const o=P(s),c=()=>{w(s,e,n[0](o,t))};A(t,s,c,n[1],o),c()}},"@":(s,o,e,n)=>{const[c,...r]=a(n.slice(1)).split("."),i=h.create(P(o)),l=ut.js(e),f={},d=t(r),p=t=>d.has(t)&&(d.delete(t),1);let m=o;for(const t of["passive","capture","once"])p(t)&&(f[t]=!0);p("window")&&(m=k),(p("document")||d.has("outside"))&&(m=y),m.addEventListener(c,t=>{[...d].some(s=>(dt[s]||(t=>{return o=t.key,u(o.replace(/^\p{Lu}/gu,t=>t.toLowerCase()))!==(s.match(/^code-\d+$/)?String.fromCodePoint(+s.split("-")[1]):s);var o}))(t,o,d))||(t=>{i.$event=t,l[0](i,s)})(t)},f),w(o,n)},"#class":(t,s,o,e)=>{const n=ut.js(o),c=P(s),r=()=>{for(const[o,e]of g(n[0](c,t)))x(s,o,!!e)};A(t,s,r,n[1],c),r(),w(s,e)},"#ref":(t,s,o,e)=>{const n=a(o);pt(t,n,s),w(s,e)},".":(t,s,o,e)=>{const n=ut.js(o),c=a(e.slice(1)),r=P(s),i=()=>{const o=n[0](r,t);s[c]=o};A(t,s,i,n[1],r),i(),w(s,e)}},wt=(t,s)=>("*"==t.charAt(0)?mt:$t)[t]=s,gt=(t,s)=>{for(const o of[...s.attributes]){const e=o.nodeName,n=e.charAt(0),c=$t[e]||$t[n]||$t[""];c?.(t,s,o.nodeValue||"",e)}},bt=(t,s,o)=>{const e=o.attributes;if(e){let r;for(const[t,s]of g(mt)){const o=e.getNamedItem(t);o&&(r&&I(`${r[0]} breaks ${t}`),r=[t,s,o.nodeValue||""])}if(r){const e=(n=`${r[0]}=${c=r[2],JSON.stringify(c)}`,y.createComment(n));return o.before(e),s.previousNode(),o.remove(),s.nextNode(),w(o,r[0]),r[1](t,e,o,r[2],r[0]),s.previousNode(),1}}var n,c},yt=(t,s)=>{const o=ut.text(s.textContent||"");if(o){const e=P(s),n=()=>{s.nodeValue=o[0](e,t)};return A(t,s,n,o[1],e),n(),1}},kt=(t,s)=>{const o=S();o.append(s),Ct(t,o)},Ct=(t,s)=>{const o=L(s,133);let e;for(;e=o.nextNode();){b(e)&&Ct(t,e.content);const s=e.nodeType;3==s?yt(t,e):1==s&&(bt(t,o,e)||gt(t,e))}},vt=(t,s)=>{r(t,"unlink",s)},St=_(),Et="DOMContentLoaded",Lt=(s,o,e)=>{const n=()=>{e(!0)};s.addEventListener(Et,n);const c=o.getRootNode(),r=St(c)||St(c,{s:t()}),i=()=>{e(!1)};return r.s.add(i),r.o||(r.o=new MutationObserver(()=>{for(const t of[...r.s])t()}),r.o.observe(c,{childList:!0,subtree:!0})),()=>{r.s.delete(i),s.removeEventListener(Et,n),r.s.size||(r.o.disconnect(),delete r.o)}},Mt=(t,s)=>o=>xt(t,s,o),xt=(i,l,f)=>{const h=`fudgel_${i}`,d=Tt(l.style||"",i,h,l.useShadow);f=f||class{};const k=E(),C=t=>{const s=L(t.content,1);let o;for(;o=s.nextNode();)b(o)&&C(o),x(o,h,!0)};k.innerHTML=l.template,C(k);const S={...l,attr:t(l.attr||[]),cssClassName:h,prop:t(l.prop||[]),style:d,tag:i,template:k.innerHTML};class M extends HTMLElement{static{this.observedAttributes=[...S.attr].map(u)}attributeChangedCallback(t,s,o){pt(this[e],a(t),o)}connectedCallback(){const t=S.useShadow?this.shadowRoot||this.attachShadow({mode:"open"}):this,s={...S,events:new n,host:this,root:t,tagName:i},c=new f(s);this[e]=c,c[e]=s,o.add(c),x(this,h,!0);for(const t of S.attr){const s=u(t);pt(c,t,m(this,s)),O(c,t,t=>{(p(t)||null===t)&&c[e]&&w(this,s,t)})}for(const t of S.prop)$(this,t)&&pt(c,t,this[t]),O(this,t,s=>pt(c,t,s)),O(c,t,s=>this[t]=s),this[t]=c[t];r(c,"init"),((t,s,o)=>{const e=t.ownerDocument,n=()=>{let s=t;do{if(s.nextSibling)return!0}while(s=s.parentNode)};if(s!=t||"loading"!=e.readyState||n())o();else{const s=Lt(e,t,t=>{(t||n())&&(s(),o(!0))})}})(this,t,s=>{if(c[e]){r(c,"parse",s);const e=E();e.innerHTML=S.template,Ct(c,e.content),t.innerHTML="";const n=t.getRootNode();if(S.style&&!n.querySelector("style."+h)){const t=v("style");x(t,h,!0),t.prepend((o=S.style,y.createTextNode(o))),(n.body||n).prepend(t)}t.append(e.content),r(c,"viewInit",s)}var o})}disconnectedCallback(){const t=this[e];r(t,"destroy"),o.delete(t),(t=>{for(const[s,o]of g(T(t)||{}))o.length=0})(this),delete t[e],delete this[e]}}try{customElements.define(i,M);const t=[M,f,S];s.add(t),c.emit("component",...t)}catch(t){}return M},_t=(t,s,o,e)=>{t.selectorText&&(t.selectorText=t.selectorText.split(",").map(t=>{const n=t=>`${t}.${o}`,c=(t,s)=>t.replace(/:host/,s),r=c(t=t.trim(),"")==t;return e?(r||t.includes(" "))&&(t=n(t)):(t=c(t,s),r&&(t=`${s} ${n(t)}`)),t}).join(","),s="");for(const n of t.cssRules??[])_t(n,s,o,e);return t.cssText},Tt=(t,s,o,e)=>[...M(t)].map(t=>_t(t,s,o,e)).join(""),Ot=new Map,At=[],Ht=t=>{At.includes(t)&&(At.push(t),I(`Circular dependency: ${At.map(t=>`${t.name}`).join(" -> ")}`)),At.push(t);const s=Ot.get(t)||Ot.set(t,new t).get(t);return At.pop(),s},Nt=(t,s)=>{Ot.set(t,s)};class Pt extends HTMLElement{constructor(){super(),this.l=S(),this.h=[],this.u=[],this.p=[];let t=this.children,s=t[0];if(b(s))this.u=Array.from(s.content.children);else for(;t.length>0;){const s=t[0];this.u.push(s),this.l.append(s)}}connectedCallback(){this.m(k,"popstate",this.$),this.m(y.body,"click",this.k),this.C(k.location.pathname),this.S(k.history,"pushState",this.L),this.S(k.history,"replaceState",this.L)}disconnectedCallback(){for(;this.p.length;)this.p.pop()()}go(t){k.history.pushState(null,"",t)}M(t){let s=!1;if(t.e!==this.h[0]){const o=m(t.e,"title"),e=m(t.e,"component");this.innerHTML="",o&&(y.title=o),this.h=[t.e,e?v(e):C(t.e)],s=!0}const o=this.h[1];for(const[s,e]of t.g)w(o,u(s),e);s&&this.append(o)}k(t){if(!t.defaultPrevented){const s=t.composedPath().filter(t=>"A"==t.tagName)[0];s&&s.href&&s.origin==k.location.origin&&!s.href.startsWith("blob:")&&(t.preventDefault(),this.go(`${s.pathname}${s.search}${s.hash}`))}}m(t,s,o){const e=o.bind(this);t.addEventListener(s,e),this.p.push(()=>t.removeEventListener(s,e))}_(t){for(const s of this.u){const o=m(s,"path")||"**",e=m(s,"regexp");let n=o;p(e)||(n=o.replace(/\*+/g,t=>t.length>1?".*":"[^/]*").replace(/:[^:\/]+/g,t=>`(?<${t.slice(1)}>[^/]+)`));const c=new RegExp(`^${n}(/.*)?$`),r=t.match(c);if(r)return{e:s,g:g(r.groups||{})}}}L(t,s){return(o,e,n)=>{s.call(t,o,e,n),this.C(n||"/")}}S(t,s,o){const e=t[s];t[s]=o.call(this,t,e),this.p.push(()=>t[s]=e)}$(){this.C(k.location.pathname)}C(t){const s=this._(t);s&&this.M(s),i(y.body,"routeChange",t)}}const jt=(t="router-outlet")=>{customElements.define(t,Pt)},It=_(),Kt=(t,s)=>t.n[s]||(t.n[s]=S()),Dt=t=>t.parentElement||(t.getRootNode()||{}).host,Ft=t(),Gt=(t="slot-like")=>{class o extends HTMLElement{constructor(){super();let t=Dt(this);for(;t&&!(this.T=It(t));)t=Dt(t)}attributeChangedCallback(t,s,o){const e=this.T;e&&s!==o&&(this.O(e,s),this.A(e))}connectedCallback(){const t=this.T;t&&(j(t.s,this),this.A(t))}disconnectedCallback(){this.T&&this.O(this.T,m(this,"name")||"")}A(t){const s=m(this,"name")||"";this.append(t.n[s]||[]),this.H=t.e.on(s,()=>{this.O(t,s),this.A(t)})}O(t,s){this.H(),Kt(t,s).append(...this.childNodes),t.e.emit(s)}}o.observedAttributes=["name"],customElements.define(t,o),c.on("init",t=>{if(Ft.has(t.constructor)){const{root:s,host:o,events:c}=t[e];c.on("parse",()=>{const t=s.innerHTML;c.on("destroy",()=>s.innerHTML=t);const e=It(s,{e:new n,n:{"":S()},s:P(Dt(o))});for(const t of[...s.querySelectorAll("[slot]")])Kt(e,m(t,"slot")||"").append(t);for(const t of[...s.childNodes])e.n[""].append(t)})}});const r=(s,o,e)=>{if(!e.useShadow){let s=!1,n=!1;const c=E();c.innerHTML=e.template;const r=L(c.content,1);let i;for(;i=r.nextNode();)if("SLOT"==i.nodeName){s=!0;const o=v(t);for(const t of i.attributes)w(o,t.name,t.value);r.previousNode(),o.append(...i.childNodes),i.replaceWith(o)}else"SLOT-LIKE"==i.nodeName&&(n=!0);s&&(e.template=c.innerHTML),(s||n)&&Ft.add(o)}};for(const t of s)r(...t);c.on("component",r)},Jt=(t,...s)=>String.raw({raw:t},...s),Rt=Jt;export{Mt as Component,n as Emitter,Pt as RouterComponent,wt as addDirective,s as allComponents,xt as component,Jt as css,jt as defineRouterComponent,Gt as defineSlotComponent,Ht as di,Nt as diOverride,i as emit,c as events,m as getAttribute,P as getScope,Rt as html,kt as link,Ct as linkNodes,e as metadata,ut as parse,w as setAttribute,vt as unlink,l as update};