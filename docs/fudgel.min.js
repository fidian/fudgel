const t=()=>{const t=new WeakMap;return(e,n)=>t.get(e)||n&&t.set(e,n).get(e)},e=t(),n=t(),o=t(),s=new Map,r=t(),c=t(),i=t(),a=t(),l={},h=t(),f=t(),u=(t,e,...n)=>{p(l,t,e,...n),p(h(e)||{},t,...n)},p=(t,e,...n)=>{for(const o of t[e]||[])t[e].includes(o)&&o(...n)},d=t=>{const e=[t];let n;for(;n=e.shift();){for(const t of f(n,[]))t();for(const t of n.childNodes)e.push(t)}},m=(t,e,n,o)=>{const s=h(t,{});s[n]?s[n].push(o):s[n]=[o];f(e,[]).push((()=>{const e=h(t);e&&e[n]&&(e[n]=e[n].filter((t=>t!==o)))}))},g=(t,e)=>((l[t]||(l[t]=[])).push(e),()=>{l[t]=l[t].filter((t=>t!==e))}),b=(t,e,n,o={})=>{t.dispatchEvent(new CustomEvent(e,{bubbles:!0,cancelable:!1,composed:!0,detail:n,...o}))},v=(t,e,n,o={})=>{const r=s.get(t);r&&b(r,e,n,o)},w=(t,e)=>{if(t)y(t,e);else for(const t of s.keys())y(t)},y=(t,e)=>{if(t.onChange){const e=o(t);for(const n of[...e.prop||[],...e.attr||[]])t.onChange(n,t[n],t[n])}u(`set:${e||""}`,t,t)},C=t=>t.entries?t.entries():Object.entries(t),E=t=>{const e=new Map;return n=>{if(e.has(n))return e.get(n);const o=t(n);return e.set(n,o),o}},L=t=>t.replace(/-(\p{Ll})/gu,(t=>t[1].toUpperCase())),$=t=>t.replace(/\p{Lu}/gu,(t=>`-${t[0]}`.toLowerCase())),M=t=>null==t?"":`${t}`,S=t=>"string"==typeof t,T=(t,e)=>t.getAttribute(e),N=t=>{const e=s.get(t);return e?e.shadowRoot||e:null},k=(t,e,n)=>{!0===n&&(n=""),S(n)?t.setAttribute(e,n):t.removeAttribute(e)},x=(t,e)=>[...new Set([...t,...e])],A=(t,e)=>"function"==typeof t[e]?t[e].bind(t):t[e],H=document,I=window,P=t=>t.cloneNode(!0),R=t=>H.createElement(t),j=()=>H.createDocumentFragment(),O=t=>{const e=R("style");return e.append((t=>H.createTextNode(t))(t)),e},D=()=>R("template"),K=(t,e)=>H.createTreeWalker(t,e),V=t=>{const e=H.implementation.createHTMLDocument(""),n=e.createElement("style");return n.textContent=t,e.body.append(n),n.sheet.cssRules},G=(t,e,n)=>{const o=i(t,{});let s=o[e];if(!s){let n=t[e];const r=Object.getOwnPropertyDescriptor(t,e)||{};s=[],o[e]=s,Object.defineProperty(t,e,{get:r.get||(()=>n),set:function(t){const e=n;if(t!==e){r.set?r.set(t):n=t;for(const n of s)n(this,t,e)}}})}s.push(n)};function W(t,e,n,o,s){m(t,e,"set:",n);for(const r of o){const o=`set:${r}`;r in s?(G(s,r,((e,n,s)=>{u(o,e,t,n,s)})),m(s,e,o,n)):(G(t,r,((t,e,n)=>{u(o,t,t,e,n),t.onChange&&t.onChange(r,e,n)})),m(t,e,o,n))}}const F=t=>{let e=a(t);if(t){let n=t.parentNode;for(;!e&&n;)e=a(n),n=n.parentNode}return e||(e={},a(H.body,e)),e},_=(t,e)=>{const n=Object.create(t);return a(e,n),n},q=(t,e)=>new Proxy(t,{get:(t,n)=>A(n in e?e:t,n)});let J="",U=0,z=0;const B={b:"\b",f:"\f",n:"\n",r:"\r",t:"\t",v:"\v"},Q={"-":t=>e=>-t(e),"!":t=>e=>!t(e),"~":t=>e=>~t(e),"+":t=>e=>+t(e)},X={"||":[1,(t,e)=>n=>t(n)||e(n)],"&&":[2,(t,e)=>n=>t(n)&&e(n)],"|":[3,(t,e)=>n=>t(n)|e(n)],"^":[4,(t,e)=>n=>t(n)^e(n)],"&":[5,(t,e)=>n=>t(n)&e(n)],"==":[6,(t,e)=>n=>t(n)==e(n)],"!=":[6,(t,e)=>n=>t(n)!=e(n)],"===":[6,(t,e)=>n=>t(n)===e(n)],"!==":[6,(t,e)=>n=>t(n)!==e(n)],"<":[7,(t,e)=>n=>t(n)<e(n)],">":[7,(t,e)=>n=>t(n)>e(n)],"<=":[7,(t,e)=>n=>t(n)<=e(n)],">=":[7,(t,e)=>n=>t(n)>=e(n)],"<<":[8,(t,e)=>n=>t(n)<<e(n)],">>":[8,(t,e)=>n=>t(n)>>e(n)],">>>":[8,(t,e)=>n=>t(n)>>>e(n)],"+":[9,(t,e)=>n=>t(n)+e(n)],"-":[9,(t,e)=>n=>t(n)-e(n)],"*":[10,(t,e)=>n=>t(n)*e(n)],"/":[10,(t,e)=>n=>t(n)/e(n)],"%":[10,(t,e)=>n=>t(n)%e(n)]},Y={true:()=>!0,false:()=>!1,null:()=>null},Z=t=>{J=t,U=0,tt(0);let e=[()=>{},[]];try{e=ct()||st()}catch(t){}return e},tt=(t=1)=>{U+=t,z=J.charCodeAt(U)},et=()=>J.charAt(U),nt=t=>t>=48&&t<=57,ot=t=>t>=65&&t<=90||t>=97&&t<=122||t>=128||36===t||95===t,st=()=>{const t=`Parse error at index ${U}: ${J}`;throw console.error(t),new Error(t)},rt=()=>{for(;32===z||9===z||10===z||13===z;)tt()},ct=()=>{const t=at();return rt(),t},it=()=>{rt();let t,e=J.substr(U,3),n=3;for(;n>0;){if(t=X[e],t){tt(n);break}e=e.substr(0,--n)}return t},at=()=>{let t,e,n,o,s,r,c;if(s=lt(),!s)return s;if(e=it(),!e)return s;for(r=lt()||st(),o=[s,e,r],c=()=>{let t=o.pop(),e=o.pop(),n=o.pop();o.push([e[1](n[0],t[0]),x(n[1],t[1])])};n=it();){for(;o.length>2&&n[0]<=o[o.length-2][0];)c();t=lt()||st(),o.push(n,t)}for(;o.length>1;)c();return o[0]},lt=()=>{let t;if(rt(),nt(z)||46===z)return ft();if(39===z||34===z)t=ut();else{const e=Q[et()];if(e){tt();const t=lt()||st();return[e(t[0]),t[1]]}ot(z)||st();const n=pt();t=Y[n]?[Y[n],[]]:[t=>A(t,n),[n]]}return ht(t)},ht=t=>{for(rt();46===z||91===z||40===z||63===z;){let e,n,o=[],s=t;if(63===z&&(tt(),rt(),46!==z&&st(),e=!0),91===z){tt();const t=ct()||st();n=(e,n)=>A(e,t[0](n)),o=t[1],93!==z&&st(),tt()}else if(40===z){tt();const t=dt();n=(e,n)=>e(...t.map((t=>t[0](n)))),o=t.reduce(((t,e)=>x(t,e[1])),o)}else if(46===z){tt(),rt();const t=pt();n=e=>A(e,t)}else st();t=e?[t=>{const e=s[0](t);return void 0===e?void 0:n(e,t)},x(s[1],o)]:[t=>n(s[0](t),t),x(s[1],o)],rt()}return t},ft=()=>{let t="";for(;nt(z);)t+=et(),tt();if(46===z)for(t+=".",tt();nt(z);)t+=et(),tt();if(101===z||69===z){t+=et(),tt(),43!==z&&45!==z||(t+=et(),tt());let e=!0;for(;nt(z);)t+=et(),tt(),e=!1;e&&st()}ot(z)?st():46!==z&&"."!==t||st();const e=parseFloat(t);return[()=>e,[]]},ut=()=>{let t="";const e=z;for(tt();U<J.length&&z!==e;){if(92===z){tt();const e=et();t+=B[e]||e}else t+=et();tt()}return U>=J.length&&st(),tt(),[()=>t,[]]},pt=()=>{let t=U;for(ot(z)?tt():st();U<J.length&&(ot(z)||nt(z));)tt();return J.slice(t,U)},dt=()=>{const t=[];for(rt();41!==z;)U>=J.length&&st(),t.push(ct()||st()),rt(),44===z?(tt(),rt()):41!==z&&st();return tt(),t},mt=t=>{const e=t.split(/{{(.*?)}}/);if(e.length<2)return null;const n=[];let o=!1,s=[];for(const t of e){if(o){const e=Z(t);n.push(e[0]),s=x(s,e[1])}else n.push(t);o=!o}return[n,s]},gt=t=>t?[e=>t[0].map((t=>M(t&&t.call?t(e):t))).join(""),t[1]]:null,bt=E((t=>{const e=mt(t);return e&&3===e[0].length&&""===e[0][0]&&""===e[0][2]?[t=>{const n=e[0][1](t);return"boolean"==typeof n?n:M(n)},e[1]]:gt(e)})),vt=E((t=>gt(mt(t)))),wt={window:()=>{},document:()=>{},stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:(t,e)=>t.target!==e,outside:(t,e)=>e.contains(t.target),ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>0!==t.button,middle:t=>1!==t.button,right:t=>2!==t.button,exact:(t,e,n)=>["ctrl","shift","alt","meta"].some((e=>t[`${e}Key`]&&!n.has(e)))},yt=[{"*for":(t,e,n,o)=>{let s="key",r="value";const c=o.match(/^\s*(?:(?:(\S+)\s*,\s*)?(\S+)\s+of\s+)?(\S+)\s*$/);c&&(s=c[1]||s,r=c[2]||r,o=c[3]);const i=Z(o),a=F(e);let l=new Map;const h=t=>{const o=i[0](q(t,a))||[];let c=l;l=new Map;let h=e;for(const[e,i]of C(o)){let o=c.get(e);if(c.delete(e),o===h.nextSibling){F(o)[r]=i}else{o&&(d(o),o.remove()),o=P(n);const c=_(a,o);c[s]=e,c[r]=i,St(o,t),h.after(o)}h=o,l.set(e,h)}for(const t of c.values())d(t),t.remove()};W(t,e,h,i[1],a),h(t)},"*if":(t,e,n,o)=>{const s=Z(o),r=F(e);let c=null;const i=t=>{s[0](q(t,r))?c||(c=P(n),_(r,c),St(c,t),e.after(c)):c&&(d(c),c.remove(),c=null)};W(t,e,i,s[1],r),i(t)},"*repeat":(t,e,n,o)=>{let s="index";const r=o.match(/^(\S+)\s+as\s+(\S+)$/);r&&(o=r[1],s=r[2]);const c=Z(o),i=F(e);let a=[];const l=t=>{let o=+c[0](q(t,i));for(;a.length>o;){const t=a.pop();d(t),t.remove()}let r=a.length+1,l=a[r-1]||e;for(;a.length<o;){let e=P(n);_(i,e)[s]=r++,St(e,t),a.push(e),l.after(e),l=e}};W(t,e,l,c[1],i),l(t)}},{"":(t,e,n,o)=>{const s=bt(n);if(s){const n=F(e),r=t=>{k(e,o,s[0](q(t,n)))};W(t,e,r,s[1],n),r(t)}},"@":(t,e,n,o)=>{const[s,...r]=L(o.slice(1)).split("."),c=Object.create(F(e)),i=Z(n),a={},l=new Set(r);let h=e;for(const t of["passive","capture","once"])l.has(t)&&(a[t]=!0);l.has("window")&&(h=I),(l.has("document")||l.has("outside"))&&(h=H),h.addEventListener(s,(n=>{r.some((t=>(wt[t]||(e=>{return n=e.key,$(n.replace(/^\p{Lu}/gu,(t=>t.toLowerCase())))!==(t.match(/^code-\d+$/)?String.fromCodePoint(+t.split("-")[1]):t);var n}))(n,e,l)))||(e=>{c.$event=e,i[0](q(t,c))})(n)}),a),k(e,o)},"#ref":(t,e,n,o)=>{t[L(n)]=e,k(e,o)},".":(t,e,n,o)=>{const s=Z(n),r=L(o.slice(1)),c=F(e),i=t=>{const n=s[0](q(t,c));e[r]=n};W(t,e,i,s[1],c),i(t),k(e,o)}}],Ct=(t,e)=>yt["*"===t.charAt(0)?0:1][t]=e;function Et(t,e){if(1===e.nodeType)for(const n of[...e.attributes]){const o=n.nodeName,s=o.charAt(0),r=yt[1],c=r[o]||r[s]||r[""];c&&c(t,e,n.nodeValue||"",o)}}const Lt=(t,e,n)=>{const o=n.attributes;if(1===n.nodeType&&o){let c;for(const[t,e]of C(yt[0])){const n=o.getNamedItem(t);if(n){if(c)throw new Error(`${c[0]} breaks ${t}`);c=[t,e,n.nodeValue||""]}}if(c){const o=(s=`${c[0]}=${r=c[2],JSON.stringify(r)}`,H.createComment(s));return n.before(o),e.previousNode(),n.remove(),k(n,c[0]),c[1](t,o,n,c[2],c[0]),1}}var s,r};function $t(t,e){if(3===e.nodeType){const n=vt(e.textContent||"");if(n){const o=F(e),s=t=>{e.nodeValue=n[0](q(t,o))};return W(t,e,s,n[1],o),s(t),1}}}const Mt=(t,e)=>{const n=K(t,133);let o;for(;o=n.nextNode();)"TEMPLATE"===o.nodeName&&Mt(o.content,e),Lt(e,n,o)||$t(e,o)||Et(e,o)},St=(t,e)=>{const n=j();n.append(t),Mt(n,e)};class Tt extends HTMLElement{constructor(){super()}attributeChangedCallback(t,e,n){const o=L(t),s=r(this);s&&this.µt(s,o,n)}connectedCallback(){const t=this.constructor,c=new(n(t)),i=e(t),a=i.useShadow,l=a?this.shadowRoot||this.attachShadow({mode:"open"}):this;r(this,c),s.set(c,this),o(c,i),this.classList.add(i.className),this.µe(i,c),c.onInit&&c.onInit(),u("init",c,c);const h=D();h.innerHTML=i.template,Mt(h.content,c),a||this.µn(),i.style&&l.append(O(i.style)),l.append(h.content),c.onViewInit&&c.onViewInit()}disconnectedCallback(){const t=r(this);t&&t.onDestroy&&t.onDestroy(),d(this),s.delete(t),this.µn()}µe(t,e){for(const n of t.prop||[]){const t=(t,e)=>{const o=r(t);this.µt(o,n,e)};G(this,n,t),t(this,this[n]);const o=(t,e)=>{const o=s.get(t);o&&(o[n]=e)};G(e,n,o),o(e,e[n])}for(const n of t.attr||[]){const o=$(n);if(this.µt(e,n,T(this,o)),!(t.prop||[]).includes(n)){G(e,n,((t,e)=>{const n=s.get(t);n&&k(n,o,e)}))}}}µt(t,e,n){const o=t[e];t[e]=n,t.onChange&&t.onChange(e,o,n)}µn(){this.innerHTML="",this.shadowRoot&&(this.shadowRoot.innerHTML="")}}let Nt=new Map,kt=()=>{var t;Nt=I[t="__fudgel"]||(I[t]=Nt),kt=()=>{}};const xt=(t,e)=>n=>{Ht(t,e,n)},At=customElements,Ht=(t,o,s)=>{kt();const r=`fudgel-${(()=>{const t=Nt.get("n")||0;return Nt.set("n",t+1),t})()}`,c=Pt(o.style||"",t,r,o.useShadow),i={...o,className:r,style:c},a=class extends Tt{static observedAttributes=(i.attr||[]).map($)};e(a,i),n(a,s||class{});const l=D();l.innerHTML=i.template,It(l,r),i.template=l.innerHTML,u("component",a,a,i),At.get(t)||At.define(t,a)},It=(t,e)=>{const n=K(t.content,1);let o;for(;o=n.nextNode();)"TEMPLATE"===o.nodeName&&It(o,e),o.classList.add(e)},Pt=(t,e,n,o)=>{const s=(t,e)=>{t[Rt]&&(t[Rt]=t[Rt].split(",").map((t=>r(t,e))).join(","),e="");for(const n of t.cssRules)s(n,e);return t.cssText},r=(t,e)=>{const s=t=>`${t}.${n}`,r=(t,e)=>t.replace(/:host/,e),c=r(t=t.trim(),"")===t;return o?(c||t.includes(" "))&&(t=s(t)):(t=r(t,e),c&&(t=`${e} ${s(t)}`)),t};return[...V(t)].map((t=>s(t,e))).join("")},Rt="selectorText",jt=new Map,Ot=[],Dt=t=>{if(Ot.includes(t))throw Ot.push(t),new Error(`Circular dependency: ${Ot.map((t=>`${t.name}`)).join(" -> ")}`);Ot.push(t);const e=jt.get(t)||jt.set(t,new t).get(t);return Ot.pop(),e},Kt=(t,e)=>{jt.set(t,e)};class Vt{µo=new Map;emit=(t,...e)=>{for(const n of[...this.µs(t)])n(...e)};off=(t,e)=>{const n=this.µs(t);for(let t=n.length-1;t>=0;t-=1)n[t]===e&&n.splice(t,1)};on=(t,e)=>this.µs(t).push(e)&&(()=>this.off(t,e));µs=t=>this.µo.get(t)||this.µo.set(t,[]).get(t)}class Gt extends HTMLElement{µr=j();µc=[];µi=[];µa=[];constructor(){super();let t=this.children,e=t[0];if("TEMPLATE"===e.nodeName)this.µi=Array.from(e.content.children);else for(;t.length>0;){const e=t[0];this.µi.push(e),this.µr.append(e)}}connectedCallback(){this.µl(I,"popstate",this.µh),this.µl(H.body,"click",this.µf),this.µu(I.location.pathname),this.µp(I.history,"pushState",this.µd),this.µp(I.history,"replaceState",this.µd)}disconnectedCallback(){for(;this.µa.length;)this.µa.pop()()}go(t){I.history.pushState(null,"",t)}µm(t){let e=!1;if(t.e!==this.µc[0]){const n=T(t.e,"title"),o=T(t.e,"component");this.innerHTML="",n&&(H.title=n),this.µc=[t.e,o?R(o):P(t.e)],e=!0}const n=this.µc[1];for(const[e,o]of t.g)k(n,$(e),o);e&&this.append(n)}µf(t){if(!t.defaultPrevented){const e=t.composedPath().filter((t=>"A"===t.tagName))[0];e&&e.href&&e.origin===I.location.origin&&(t.preventDefault(),this.go(`${e.pathname}${e.search}${e.hash}`))}}µl(t,e,n){const o=n.bind(this);t.addEventListener(e,o),this.µa.push((()=>t.removeEventListener(e,o)))}µg(t){for(const e of this.µi){const n=T(e,"path")||"**",o=T(e,"regexp");let s=n;S(o)||(s=n.replace(/\*+/g,(t=>t.length>1?".*":"[^/]*")).replace(/:[^:\/]+/g,(t=>`(?<${t.slice(1)}>[^/]+)`)));const r=new RegExp(`^${s}(/.*)?$`),c=t.match(r);if(c)return{e,g:Object.entries(c.groups||{})}}return null}µd(t,e){return(n,o,s)=>{e.call(t,n,o,s),this.µu(s||"/")}}µp(t,e,n){const o=t[e];t[e]=n.call(this,t,o),this.µa.push((()=>t[e]=o))}µh(){this.µu(I.location.pathname)}µu(t){const e=this.µg(t);e&&this.µm(e),b(H.body,"routeChange",t)}}const Wt=(t="router-outlet")=>{customElements.define(t,Gt)},Ft=(t,e)=>t.n[e]||(t.n[e]=j()),_t=t=>t.parentElement||(t.getRootNode()||{}).host;class qt extends HTMLElement{static observedAttributes=["name"];µb;µv;constructor(){super();let t=_t(this);for(;t&&!(this.µv=c(t));)t=_t(t)}attributeChangedCallback(t,e,n){const o=this.µv;o&&e!==n&&(this.µw(o,e),this.µy(o))}connectedCallback(){const t=this.µv;t&&(a(this,t.s),this.µy(t))}disconnectedCallback(){this.µv&&this.µw(this.µv,T(this,"name")||"")}µy(t){const e=T(this,"name")||"";this.append(t.n[e]||[]),this.µb=t.e.on(e,(()=>{this.µw(t,e),this.µy(t)}))}µw(t,e){this.µb(),Ft(t,e).append(...this.childNodes),t.e.emit(e)}}const Jt=(t="slot-like")=>{customElements.define(t,qt),g("component",((e,n)=>{if(!n.useShadow){const e=D();e.innerHTML=n.template;const o=K(e.content,1);let s;for(;s=o.nextNode();)if("SLOT"===s.nodeName){const e=R(t);for(const t of s.attributes)k(e,t.name,t.value);o.previousNode(),e.append(...s.childNodes),s.replaceWith(e)}n.template=e.innerHTML}})),g("init",(t=>{const e=N(t),n=o(t);if(e&&!n.useShadow){const n={e:new Vt,n:{"":j()},s:F(_t(s.get(t)))};for(const t of e.querySelectorAll("[slot]"))Ft(n,T(t,"slot")||"").append(t);for(const t of e.childNodes)n.n[""].append(t);c(e,n)}}))},Ut=(t,...e)=>String.raw({raw:t},...e),zt=Ut;export{xt as Component,Tt as CustomElement,Vt as Emitter,Ct as addDirective,Ht as component,zt as css,Wt as defineRouterComponent,Jt as defineSlotComponent,Dt as di,Kt as diOverride,b as dispatchCustomEvent,v as emit,T as getAttribute,g as hookOnGlobal,Ut as html,s as metadataControllerElement,vt as parseText,bt as parseTextAllowBoolean,N as rootElement,k as setAttribute,w as update,y as updateController};
