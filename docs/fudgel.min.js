const t=()=>{const t=new WeakMap;return(s,n)=>t.get(s)||n&&t.set(s,n).get(s)},s=t(),n=t(),e=t(),o=new Map,c=t(),r=t(),i=t(),l=t(),f=t(),h=(t,s,n)=>{const e=l(t,{});let o=e[s];if(!o){let n=t[s];const c=Object.getOwnPropertyDescriptor(t,s)||{};o=[],e[s]=o,Object.defineProperty(t,s,{get:c.get||(()=>n),set:function(t){const s=n;if(t!==s){c.set?.(t),n=t;for(const n of o)n(this,t,s)}}})}o.push(n)},u={},a=t(),d=t(),p=t(),w=(t,s,...n)=>{m(u,t,s,...n),m(a(s)||{},t,...n)},m=(t,s,...n)=>{for(const e of t[s]||[])t[s].includes(e)&&e(...n)},b=t=>{const s=[t];let n;for(;n=s.shift();){for(const t of d(n,[]))t();for(const t of n.childNodes)s.push(t)}},$=(t,s,n,e)=>{const o=a(t,{});o[n]?o[n].push(e):o[n]=[e];d(s,[]).push((()=>{const s=a(t);s?.[n]&&(s[n]=s[n].filter((t=>t!==e)))}))},g=(t,s)=>((u[t]||(u[t]=[])).push(s),()=>{u[t]=u[t].filter((t=>t!==s))}),C=(t,s,n)=>{const e=p(s,{});e[n]||(e[n]=1,h(s,n,((s,e,o)=>{w(`set:${n}`,s,t,e,o)})))},E=(t,s,n,e={})=>{t.dispatchEvent(new CustomEvent(s,{bubbles:!0,cancelable:!1,composed:!0,detail:n,...e}))},k=(t,s,n,e={})=>{const c=o.get(t);c&&E(c,s,n,e)},M=(t,s)=>{if(t)S(t,s);else for(const t of o.keys())S(t)},S=(t,s)=>{if(t.onChange){const s=e(t);for(const n of[...s.prop||[],...s.attr||[]])t.onChange(n,t[n],t[n])}w(`set:${s||""}`,t,t)},_=t=>t.entries?t.entries():Object.entries(t),v=t=>{const s=new Map;return n=>{if(s.has(n))return s.get(n);const e=t(n);return s.set(n,e),e}},y=t=>t.replace(/-(\p{Ll})/gu,(t=>t[1].toUpperCase())),L=t=>t.replace(/\p{Lu}/gu,(t=>`-${t[0]}`.toLowerCase())),x=t=>`${t??""}`,T=t=>"string"==typeof t,O=(t,s)=>t.getAttribute(s),j=t=>{const s=o.get(t);return s?.shadowRoot??s??null},A=(t,s,n)=>{!0===n&&(n=""),T(n)?t.setAttribute(s,n):t.removeAttribute(s)},P=(t,s)=>[...new Set([...t,...s])],H=(t,s)=>"function"==typeof t[s]?t[s].bind(t):t[s],N=document,D=window,F=t=>t.cloneNode(!0),G=t=>N.createElement(t),J=()=>N.createDocumentFragment(),K=t=>{const s=G("style");return s.append((t=>N.createTextNode(t))(t)),s},R=()=>G("template"),W=(t,s)=>N.createTreeWalker(t,s),q=t=>{const s=N.implementation.createHTMLDocument(""),n=s.createElement("style");return n.textContent=t,s.body.append(n),n.sheet.cssRules||[]};function z(t,s,n,e,o){$(t,s,"set:",n);for(const c of e){const e=`set:${c}`;c in o?(C(t,o,c),$(o,s,e,n)):(C(t,t,c),h(t,c,((t,s,n)=>{t.onChange?.(c,s,n)})),$(t,s,e,n))}}const B=t=>{let s=f(t);if(t){let n=t.parentNode;for(;!s&&n;)s=f(n),n=n.parentNode}return s||(s={},f(N.body,s)),s},I=(t,s)=>{const n=Object.create(t);return f(s,n),n},Q=(t,s)=>new Proxy(t,{get:(t,n)=>H(n in s?s:t,n)});let U="",V=0,X=0;const Y={b:"\b",f:"\f",n:"\n",r:"\r",t:"\t",v:"\v"},Z={"-":t=>s=>-t(s),"!":t=>s=>!t(s),"~":t=>s=>~t(s),"+":t=>s=>+t(s)},tt={"||":[1,(t,s)=>n=>t(n)||s(n)],"&&":[2,(t,s)=>n=>t(n)&&s(n)],"|":[3,(t,s)=>n=>t(n)|s(n)],"^":[4,(t,s)=>n=>t(n)^s(n)],"&":[5,(t,s)=>n=>t(n)&s(n)],"==":[6,(t,s)=>n=>t(n)==s(n)],"!=":[6,(t,s)=>n=>t(n)!=s(n)],"===":[6,(t,s)=>n=>t(n)===s(n)],"!==":[6,(t,s)=>n=>t(n)!==s(n)],"<":[7,(t,s)=>n=>t(n)<s(n)],">":[7,(t,s)=>n=>t(n)>s(n)],"<=":[7,(t,s)=>n=>t(n)<=s(n)],">=":[7,(t,s)=>n=>t(n)>=s(n)],"<<":[8,(t,s)=>n=>t(n)<<s(n)],">>":[8,(t,s)=>n=>t(n)>>s(n)],">>>":[8,(t,s)=>n=>t(n)>>>s(n)],"+":[9,(t,s)=>n=>t(n)+s(n)],"-":[9,(t,s)=>n=>t(n)-s(n)],"*":[10,(t,s)=>n=>t(n)*s(n)],"/":[10,(t,s)=>n=>t(n)/s(n)],"%":[10,(t,s)=>n=>t(n)%s(n)]},st={true:()=>!0,false:()=>!1,null:()=>null},nt=t=>{U=t,V=0,et(0);let s=[()=>{},[]];try{s=ft()||it()}catch(t){}return s},et=(t=1)=>{V+=t,X=U.charCodeAt(V)},ot=()=>U.charAt(V),ct=t=>t>=48&&t<=57,rt=t=>t>=65&&t<=90||t>=97&&t<=122||t>=128||36===t||95===t,it=()=>{const t=`Parse error at index ${V}: ${U}`;throw console.error(t),new Error(t)},lt=()=>{for(;32===X||9===X||10===X||13===X;)et()},ft=()=>{const t=ut();return lt(),t},ht=()=>{lt();let t,s=U.substr(V,3),n=3;for(;n>0;){if(t=tt[s],t){et(n);break}s=s.substr(0,--n)}return t},ut=()=>{let t,s,n,e,o,c,r;if(o=at(),!o)return o;if(s=ht(),!s)return o;for(c=at()||it(),e=[o,s,c],r=()=>{let t=e.pop(),s=e.pop(),n=e.pop();e.push([s[1](n[0],t[0]),P(n[1],t[1])])};n=ht();){for(;e.length>2&&n[0]<=e[e.length-2][0];)r();t=at()||it(),e.push(n,t)}for(;e.length>1;)r();return e[0]},at=()=>{let t;if(lt(),ct(X)||46===X)return pt();if(39===X||34===X)t=wt();else{const s=Z[ot()];if(s){et();const t=at()||it();return[s(t[0]),t[1]]}rt(X)||it();const n=mt();t=st[n]?[st[n],[]]:[t=>H(t,n),[n]]}return dt(t)},dt=t=>{for(lt();46===X||91===X||40===X||63===X;){let s,n,e=[],o=t;if(63===X&&(et(),lt(),46!==X&&it(),s=!0),91===X){et();const t=ft()||it();n=(s,n)=>H(s,t[0](n)),e=t[1],93!==X&&it(),et()}else if(40===X){et();const t=bt();n=(s,n)=>s(...t.map((t=>t[0](n)))),e=t.reduce(((t,s)=>P(t,s[1])),e)}else if(46===X){et(),lt();const t=mt();n=s=>H(s,t)}else it();t=s?[t=>{const s=o[0](t);return void 0===s?void 0:n(s,t)},P(o[1],e)]:[t=>n(o[0](t),t),P(o[1],e)],lt()}return t},pt=()=>{let t="";for(;ct(X);)t+=ot(),et();if(46===X)for(t+=".",et();ct(X);)t+=ot(),et();if(101===X||69===X){t+=ot(),et(),43!==X&&45!==X||(t+=ot(),et());let s=!0;for(;ct(X);)t+=ot(),et(),s=!1;s&&it()}rt(X)?it():46!==X&&"."!==t||it();const s=parseFloat(t);return[()=>s,[]]},wt=()=>{let t="";const s=X;for(et();V<U.length&&X!==s;){if(92===X){et();const s=ot();t+=Y[s]||s}else t+=ot();et()}return V>=U.length&&it(),et(),[()=>t,[]]},mt=()=>{let t=V;for(rt(X)?et():it();V<U.length&&(rt(X)||ct(X));)et();return U.slice(t,V)},bt=()=>{const t=[];for(lt();41!==X;)V>=U.length&&it(),t.push(ft()||it()),lt(),44===X?(et(),lt()):41!==X&&it();return et(),t},$t=t=>{const s=t.split(/{{(.*?)}}/);if(s.length<2)return null;const n=[];let e=!1,o=[];for(const t of s){if(e){const s=nt(t);n.push(s[0]),o=P(o,s[1])}else n.push(t);e=!e}return[n,o]},gt=t=>t?[s=>t[0].map((t=>x(t?.call?t(s):t))).join(""),t[1]]:null,Ct=v((t=>{const s=$t(t),n=s?.[0];return 3===n?.length&&""===n[0]&&""===n[2]?[t=>{const s=n[1](t);return"boolean"==typeof s?s:x(s)},s[1]]:gt(s)})),Et=v((t=>gt($t(t)))),kt={window:()=>{},document:()=>{},stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:(t,s)=>t.target!==s,outside:(t,s)=>s.contains(t.target),ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>0!==t.button,middle:t=>1!==t.button,right:t=>2!==t.button,exact:(t,s,n)=>["ctrl","shift","alt","meta"].some((s=>t[`${s}Key`]&&!n.has(s)))},Mt=[{"*for":(t,s,n,e)=>{let o="key",c="value";const r=e.match(/^\s*(?:(?:(\S+)\s*,\s*)?(\S+)\s+of\s+)?(\S+)\s*$/);r&&(o=r[1]||o,c=r[2]||c,e=r[3]);const i=nt(e),l=B(s);let f=new Map;const h=t=>{const e=i[0](Q(t,l))||[];let r=f;f=new Map;let h=s;for(const[s,i]of _(e)){let e=r.get(s);if(r.delete(s),e===h.nextSibling){B(e)[c]=i}else{e&&(b(e),e.remove()),e=F(n);const r=I(l,e);r[o]=s,r[c]=i,xt(e,t),h.after(e)}h=e,f.set(s,h)}for(const t of r.values())b(t),t.remove()};z(t,s,h,i[1],l),h(t)},"*if":(t,s,n,e)=>{const o=nt(e),c=B(s);let r=null;const i=t=>{o[0](Q(t,c))?r||(r=F(n),I(c,r),xt(r,t),s.after(r)):r&&(b(r),r.remove(),r=null)};z(t,s,i,o[1],c),i(t)},"*repeat":(t,s,n,e)=>{let o="index";const c=e.match(/^(\S+)\s+as\s+(\S+)$/);c&&(e=c[1],o=c[2]);const r=nt(e),i=B(s);let l=[];const f=t=>{let e=+r[0](Q(t,i));for(;l.length>e;){const t=l.pop();b(t),t.remove()}let c=l.length+1,f=l[c-1]||s;for(;l.length<e;){let s=F(n);I(i,s)[o]=c++,xt(s,t),l.push(s),f.after(s),f=s}};z(t,s,f,r[1],i),f(t)}},{"":(t,s,n,e)=>{const o=Ct(n);if(o){const n=B(s),c=t=>{A(s,e,o[0](Q(t,n)))};z(t,s,c,o[1],n),c(t)}},"@":(t,s,n,e)=>{const[o,...c]=y(e.slice(1)).split("."),r=Object.create(B(s)),i=nt(n),l={},f=new Set(c);let h=s;for(const t of["passive","capture","once"])f.has(t)&&(l[t]=!0);f.has("window")&&(h=D),(f.has("document")||f.has("outside"))&&(h=N),h.addEventListener(o,(n=>{c.some((t=>(kt[t]||(s=>{return n=s.key,L(n.replace(/^\p{Lu}/gu,(t=>t.toLowerCase())))!==(t.match(/^code-\d+$/)?String.fromCodePoint(+t.split("-")[1]):t);var n}))(n,s,f)))||(s=>{r.$event=s,i[0](Q(t,r))})(n)}),l),A(s,e)},"#ref":(t,s,n,e)=>{t[y(n)]=s,A(s,e)},".":(t,s,n,e)=>{const o=nt(n),c=y(e.slice(1)),r=B(s),i=t=>{const n=o[0](Q(t,r));s[c]=n};z(t,s,i,o[1],r),i(t),A(s,e)}}],St=(t,s)=>Mt["*"===t.charAt(0)?0:1][t]=s;function _t(t,s){if(1===s.nodeType)for(const n of[...s.attributes]){const e=n.nodeName,o=e.charAt(0),c=Mt[1],r=c[e]||c[o]||c[""];r?.(t,s,n.nodeValue||"",e)}}const vt=(t,s,n)=>{const e=n.attributes;if(1===n.nodeType&&e){let r;for(const[t,s]of _(Mt[0])){const n=e.getNamedItem(t);if(n){if(r)throw new Error(`${r[0]} breaks ${t}`);r=[t,s,n.nodeValue||""]}}if(r){const e=(o=`${r[0]}=${c=r[2],JSON.stringify(c)}`,N.createComment(o));return n.before(e),s.previousNode(),n.remove(),A(n,r[0]),r[1](t,e,n,r[2],r[0]),1}}var o,c};function yt(t,s){if(3===s.nodeType){const n=Et(s.textContent||"");if(n){const e=B(s),o=t=>{s.nodeValue=n[0](Q(t,e))};return z(t,s,o,n[1],e),o(t),1}}}const Lt=(t,s)=>{const n=W(t,133);let e;for(;e=n.nextNode();)"TEMPLATE"===e.nodeName&&Lt(e.content,s),vt(s,n,e)||yt(s,e)||_t(s,e)},xt=(t,s)=>{const n=J();n.append(t),Lt(n,s)},Tt="DOMContentLoaded",Ot=(t,s,n)=>{const e=()=>{n(!0)};t.addEventListener(Tt,e);const o=(t=>{let s=t;do{s=(t=s).parentNode}while(s&&1===s.nodeType);return t})(s),c=i(o,{s:new Set}),r=()=>{n(!1)};return c.s.add(r),c.o||(c.o=new MutationObserver((()=>{for(const t of[...c.s])t()})),c.o.observe(o,{childList:!0,subtree:!0})),()=>{c.s.delete(r),t.removeEventListener(Tt,e),c.s.size||(c.o.disconnect(),delete c.o)}};class jt extends HTMLElement{constructor(){super()}attributeChangedCallback(t,s,n){const e=y(t),o=c(this);o&&this.i(o,e,n)}connectedCallback(){const t=this.constructor,r=new(n(t)),i=s(t),l=i.useShadow,f=l?this.shadowRoot||this.attachShadow({mode:"open"}):this;c(this,r),o.set(r,this),e(r,i),this.classList.add(i.className),this.l(i,r),r.onInit?.(),((t,s)=>{const n=t.ownerDocument,e=()=>{let s=t;do{if(s.nextSibling)return!0}while(s=s.parentNode);return!1};if("complete"===n.readyState||e())s();else{const o=Ot(n,t,(t=>{(t||e())&&(o(),s())}))}})(this,(()=>{r.onParse?.();const t=R();t.innerHTML=i.template,Lt(t.content,r),l||this.h(),i.style&&f.append(K(i.style)),f.append(t.content),r.onViewInit?.()}))}disconnectedCallback(){const t=c(this);t?.onDestroy?.(),b(this),o.delete(t),this.h()}l(t,s){for(const n of t.prop||[]){const t=(t,s)=>{const e=c(t);this.i(e,n,s)};h(this,n,t),t(this,this[n]);const e=(t,s)=>{const e=o.get(t);e&&(e[n]=s)};h(s,n,e),e(s,s[n])}for(const n of t.attr||[]){const e=L(n);if(this.i(s,n,O(this,e)),!(t.prop||[]).includes(n)){h(s,n,((t,s)=>{const n=o.get(t);n&&A(n,e,s)}))}}}i(t,s,n){const e=t[s];t[s]=n,t.onChange?.(s,e,n)}h(){this.innerHTML="",this.shadowRoot&&(this.shadowRoot.innerHTML="")}}let At=new Map,Pt=()=>{var t;At=D[t="__fudgel"]||(D[t]=At),Pt=()=>{}};const Ht=(t,s)=>n=>{Dt(t,s,n)},Nt=customElements,Dt=(t,e,o)=>{Pt();const c=`fudgel-${(()=>{const t=At.get("n")||0;return At.set("n",t+1),t})()}`,r=Gt(e.style||"",t,c,e.useShadow),i={...e,className:c,style:r};class l extends jt{}l.observedAttributes=(i.attr||[]).map(L),s(l,i),n(l,o||class{});const f=R();f.innerHTML=i.template,Ft(f,c),i.template=f.innerHTML,w("component",l,l,i),Nt.get(t)||Nt.define(t,l)},Ft=(t,s)=>{const n=W(t.content,1);let e;for(;e=n.nextNode();)"TEMPLATE"===e.nodeName&&Ft(e,s),e.classList.add(s)},Gt=(t,s,n,e)=>{const o=(t,s)=>{t[Jt]&&(t[Jt]=t[Jt].split(",").map((t=>c(t,s))).join(","),s="");for(const n of t.cssRules||[])o(n,s);return t.cssText},c=(t,s)=>{const o=t=>`${t}.${n}`,c=(t,s)=>t.replace(/:host/,s),r=c(t=t.trim(),"")===t;return e?(r||t.includes(" "))&&(t=o(t)):(t=c(t,s),r&&(t=`${s} ${o(t)}`)),t};return[...q(t)].map((t=>o(t,s))).join("")},Jt="selectorText",Kt=new Map,Rt=[],Wt=t=>{if(Rt.includes(t))throw Rt.push(t),new Error(`Circular dependency: ${Rt.map((t=>`${t.name}`)).join(" -> ")}`);Rt.push(t);const s=Kt.get(t)||Kt.set(t,new t).get(t);return Rt.pop(),s},qt=(t,s)=>{Kt.set(t,s)};class zt{constructor(){this.u=new Map,this.on=(t,s)=>this.p(t).push(s)&&(()=>this.off(t,s)),this.p=t=>this.u.get(t)||this.u.set(t,[]).get(t)}emit(t,...s){for(const n of[...this.p(t)])n(...s)}off(t,s){const n=this.p(t);for(let t=n.length-1;t>=0;t-=1)n[t]===s&&n.splice(t,1)}}class Bt extends HTMLElement{constructor(){super(),this.m=J(),this.$=[],this.C=[],this.k=[];let t=this.children,s=t[0];if("TEMPLATE"===s.nodeName)this.C=Array.from(s.content.children);else for(;t.length>0;){const s=t[0];this.C.push(s),this.m.append(s)}}connectedCallback(){this.M(D,"popstate",this.S),this.M(N.body,"click",this._),this.L(D.location.pathname),this.T(D.history,"pushState",this.O),this.T(D.history,"replaceState",this.O)}disconnectedCallback(){for(;this.k.length;)this.k.pop()()}go(t){D.history.pushState(null,"",t)}j(t){let s=!1;if(t.e!==this.$[0]){const n=O(t.e,"title"),e=O(t.e,"component");this.innerHTML="",n&&(N.title=n),this.$=[t.e,e?G(e):F(t.e)],s=!0}const n=this.$[1];for(const[s,e]of t.g)A(n,L(s),e);s&&this.append(n)}_(t){if(!t.defaultPrevented){const s=t.composedPath().filter((t=>"A"===t.tagName))[0];s&&s.href&&s.origin===D.location.origin&&(t.preventDefault(),this.go(`${s.pathname}${s.search}${s.hash}`))}}M(t,s,n){const e=n.bind(this);t.addEventListener(s,e),this.k.push((()=>t.removeEventListener(s,e)))}A(t){for(const s of this.C){const n=O(s,"path")||"**",e=O(s,"regexp");let o=n;T(e)||(o=n.replace(/\*+/g,(t=>t.length>1?".*":"[^/]*")).replace(/:[^:\/]+/g,(t=>`(?<${t.slice(1)}>[^/]+)`)));const c=new RegExp(`^${o}(/.*)?$`),r=t.match(c);if(r)return{e:s,g:Object.entries(r.groups||{})}}return null}O(t,s){return(n,e,o)=>{s.call(t,n,e,o),this.L(o||"/")}}T(t,s,n){const e=t[s];t[s]=n.call(this,t,e),this.k.push((()=>t[s]=e))}S(){this.L(D.location.pathname)}L(t){const s=this.A(t);s&&this.j(s),E(N.body,"routeChange",t)}}const It=(t="router-outlet")=>{customElements.define(t,Bt)},Qt=(t,s)=>t.n[s]||(t.n[s]=J()),Ut=t=>t.parentElement||(t.getRootNode()||{}).host,Vt=(t="slot-like")=>{class s extends HTMLElement{constructor(){super();let t=Ut(this);for(;t&&!(this.P=r(t));)t=Ut(t)}attributeChangedCallback(t,s,n){const e=this.P;e&&s!==n&&(this.H(e,s),this.N(e))}connectedCallback(){const t=this.P;t&&(f(this,t.s),this.N(t))}disconnectedCallback(){this.P&&this.H(this.P,O(this,"name")||"")}N(t){const s=O(this,"name")||"";this.append(t.n[s]||[]),this.D=t.e.on(s,(()=>{this.H(t,s),this.N(t)}))}H(t,s){this.D(),Qt(t,s).append(...this.childNodes),t.e.emit(s)}}s.observedAttributes=["name"],customElements.define(t,s),g("component",((s,e,c)=>{if(!c.useShadow){let s=!1;const i=R();i.innerHTML=c.template;const l=W(i.content,1);let f;for(;f=l.nextNode();)if("SLOT"===f.nodeName){s=!0;const n=G(t);for(const t of f.attributes)A(n,t.name,t.value);l.previousNode(),n.append(...f.childNodes),f.replaceWith(n)}s&&(c.template=i.innerHTML),function(t){const s=t.onChildren;let n;t.onParse=function(){n=j(this),r(n,{e:new zt,n:{"":J()},s:B(Ut(o.get(this)))});const t=r(n);for(const s of[...n.querySelectorAll("[slot]")])Qt(t,O(s,"slot")||"").append(s);for(const s of[...n.childNodes])t.n[""].append(s);s?.call(this)}}(n(e)?.prototype)}}))};const Xt=(t,...s)=>String.raw({raw:t},...s),Yt=Xt;export{Ht as Component,jt as CustomElement,zt as Emitter,St as addDirective,Dt as component,Yt as css,It as defineRouterComponent,Vt as defineSlotComponent,Wt as di,qt as diOverride,E as dispatchCustomEvent,k as emit,O as getAttribute,g as hookOnGlobal,Xt as html,o as metadataControllerElement,Et as parseText,Ct as parseTextAllowBoolean,j as rootElement,A as setAttribute,M as update,S as updateController};