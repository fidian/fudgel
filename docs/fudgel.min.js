const t=[{},{}],e=(e,n)=>t["*"===e.charAt(0)?0:1][e]=n,n=()=>{const t=new WeakMap;return(e,n)=>t.get(e)||n&&t.set(e,n).get(e)},o=n(),s=n(),c=new Map,r=n(),l=n(),a=n(),i=n(),f=n(),p=n(),u=n(),d=n(),h=(t,e,...n)=>{const o=r(e);if(o)for(const s of o[t]||[])o[t].includes(s)&&s(e,...n)},g=t=>{const e=[t];let n;for(;n=e.shift();){for(const t of p(n,[]))t();for(const t of n.childNodes)e.push(t)}},m=(t,e,n,o)=>{const s=r(t,{});s[n]?s[n].push(o):s[n]=[o];p(e,[]).push((()=>{const e=r(t);e&&e[n]&&(e[n]=e[n].filter((t=>t!==o)))}))},b=(t,e,n,o)=>{const s=t(e,{});if(!s[n]){s[n]=1;let t=e[n];const c=Object.getOwnPropertyDescriptor(e,n)||{};Object.defineProperty(e,n,{get:c.get||(()=>t),set:function(e){const n=t;e!==n&&(c.set?c.set(e):t=e,o(this,e,n))}})}};function y(t,e,n,o){m(t,e,"set:",n);for(const s of o){const o=`set:${s}`;b(a,t,s,((t,e,n)=>{h(o,t,e,n),t.onChange&&t.onChange(s,e,n)})),m(t,e,o,n)}}const $=t=>{let e=d(t),n=t.parentNode;for(;!e&&n;)e=d(n),n=n.parentNode;return e||{}},v=(t,e)=>{const n=Object.create(t);return d(e,n),n},w=t=>JSON.stringify(t),C=t=>{const e={};return(...n)=>{const o=w(n);return e[o]||(e[o]=t(...n))}},N=C(((t,e)=>new Function(t,e))),M=t=>N("$scope",`return ${t}`),L=t=>t.replace(/-\p{Ll}/gu,(t=>t[1].toUpperCase())),T=(t,e,n)=>{!0===n&&(n=""),"string"!=typeof n?t.removeAttribute(e):t.setAttribute(e,`${n}`)},O=C((t=>{const e=t.split(/{{(.*?)}}/);if(e.length<2)return null;const n=[];let o=!1;const s=new Set;for(const t of e){if(o){n.push(M(t));for(const e of x(t))s.add(e)}else n.push(t);o=!o}return{fn:function(t){return n.map((e=>{return e=e&&e.call?e.call(this,t):e,null==(n=e)?"":`${n}`;var n})).join("")},binds:s}})),S=/this\.((?:\$|_|\p{L}|\p{Nl})(?:\$|_|\p{L}|\p{Nl}|\u200C|\u200D|\p{Mn}|\p{Mc}|\p{Nd})*)/u,x=C((t=>{const e=new Set,n=t.split(S);for(let t=1;t<n.length;t+=2)e.add(n[t]);return e})),E=document,j=t=>E.createElement(t),k=t=>{const e=j("style");return e.appendChild((t=>E.createTextNode(t))(t)),e};function A(e,n){if(1===n.nodeType){for(const o of[...n.attributes]){const s=o.nodeName,c=s.charAt(0),r=t[1],l=r[s]||r[c]||r[""];l&&l(e,n,o.nodeValue||"",s)}const o=O(n.textContent||"");if(o){const t=t=>{n.nodeValue=o.fn.call(t,$(n))};y(e,n,t,o.binds),t(e)}}return 1}const D=(e,n,o)=>{const s=o.attributes;if(1===o.nodeType&&s){let r;for(const[e,n]of Object.entries(t[0])){const t=s.getNamedItem(e);if(t){if(r)throw new Error(`${r[0]} breaks ${e}`);r=[e,n,t.nodeValue||""]}}if(r){const t=(c=`${r[0]}=${w(r[2])}`,E.createComment(c));return o.before(t),n.previousNode(),o.remove(),T(o,r[0]),r[1](e,t,o,r[2],r[0]),1}}var c};function V(t,e){if(3===e.nodeType){const n=O(e.textContent||"");if(n){const o=t=>{e.nodeValue=n.fn.call(t,$(e))};return y(t,e,o,n.binds),o(t),1}}}const I=(t,e)=>{const n=E.createTreeWalker(t,133);let o;for(;o=n.nextNode();)"TEMPLATE"===o.nodeName&&I(o.content,e),D(e,n,o)||V(e,o)||A(e,o)},P=(t,e)=>{const n=E.createDocumentFragment();n.append(t),I(n,e)},H=(t,e,n,o={})=>{const s=c.get(t);s&&s.dispatchEvent(new CustomEvent(e,Object.assign({bubbles:!0,cancelable:!1,composed:!0,detail:n},o)))},F=(t,e)=>{if(t)h(`set:${e||""}`,t);else for(const t of c.keys())h("set:",t)},R=(t,e)=>{"function"==typeof t&&(t=t.prototype),u(t,[]).push(e)},W=()=>J,_=(t,e)=>J(t.constructor.prototype,e),J=(t,e)=>R(t,(t=>{m(t,c.get(t),"init",(t=>{const n=e.replace(/\p{Lu}/gu,(t=>`-${t[1]}`.toLowerCase()));const o=c.get(t);if(o){const s=(t,n,o)=>{t[e]=o,t.onChange&&t.onChange(e,n,o)};m(t,o,`attr:${n}`,s),s(t,null,o.getAttribute(e))}b(l,t,e,((t,e)=>{const o=c.get(t);o&&T(o,n,e)}))}))}));class U extends HTMLElement{constructor(){super(),d(this,{})}attributeChangedCallback(t,e,n){const o=i(this);h(`attr:${t}`,o,e,n)}connectedCallback(){const t=this.constructor,e=new(s(t));i(this,e),c.set(e,this),(t=>{let e=t.constructor.prototype;for(;e;){for(const n of u(e)||[])n(t);n=e,e=Object.getPrototypeOf(n)}var n})(e);const n=o(t),r=this.shadowRoot||this.attachShadow({mode:"open"});n.style&&r.appendChild(k(n.style)),e.onInit&&e.onInit(),h("init",e);const l=n.template,a=j("template");a.innerHTML=l,I(a.content,e),r.append(a.content),e.onViewInit&&e.onViewInit()}disconnectedCallback(){const t=i(this);g(this),c.delete(t),this.innerHTML="",this.shadowRoot.innerHTML="",t.onDestroy&&t.onDestroy()}}const q=(t,e)=>n=>{B(t,e,n)},z=customElements,B=(t,e,n)=>{const c=class extends U{};o(c,e),s(c,n||class{}),z.get(t)||z.define(t,c)},G=()=>Q,K=(t,e)=>Q(t.constructor.prototype,e),Q=(t,e)=>{R(t,(t=>{m(t,c.get(t),"init",(t=>{const n=c.get(t);if(n){const t=(t,n)=>{i(t)[e]=n};b(f,n,e,t),t(n,n[e])}}))}))};e("",((t,e,n,o)=>{const s=O(n);if(s){const n=t=>{const n=s.fn.call(t,$(e));T(e,o,n)};y(t,e,n,s.binds),n(t)}})),e("@",((t,e,n,o)=>{const s=L(o.slice(1)),c=$(e),r=N("s,e",`!1===(($scope,$event)=>{${n}})(s,e)&&(e.preventDefault(),e.stopPropagation())`);e.addEventListener(s,(e=>r.call(t,c,e))),T(e,o)})),e("#ref",((t,e,n,o)=>{t[L(n)]=e,T(e,o)})),e(".",((t,e,n,o)=>{const s=M(n),c=L(o.slice(1)),r=$(e),l=t=>{const n=s.call(t,r);e[c]=n};y(t,e,l,x(n)),l(t),T(e,o)})),e("*for",((t,e,n,o)=>{let s="key",c="value";const r=o.match(/^\s*(?:(?:(\S+)\s*,\s*)?(\S+)\s+of\s+)?(\S+)\s*$/);r&&(s=r[1]||s,c=r[2]||c,o=r[3]);const l=M(o),a=$(e);let i=new Map;const f=t=>{const o=l.call(t,a)||[];let r=i;i=new Map;let f=e;const p=()=>o.entries?o.entries():Object.entries(o),u=new Map(r);for(const[t]of p())u.delete(t);for(const t of u.values())g(t),t.remove(),r.delete(t);for(const[e,o]of p()){let l=r.get(e);if(r.delete(e),l!==f.nextSibling){l&&(g(l),l.remove()),l=n.cloneNode(!0);const r=v(a,l);r[s]=e,r[c]=o,P(l,t),f.after(l)}else{v(a,l)[c]=o}f=l,i.set(e,f)}for(const t of r.values())g(t),t.remove()};y(t,e,f,x(o)),f(t)})),e("*if",((t,e,n,o)=>{const s=M(o),c=$(e);let r=null;const l=t=>{s.call(t,c)?r||(r=n.cloneNode(!0),P(r,t),e.after(r)):r&&(g(r),r.remove(),r=null)};y(t,e,l,x(o)),l(t)})),e("*repeat",((t,e,n,o)=>{let s="index";const c=o.match(/^(\S+)\s+as\s+(\S+)$/);c&&(o=c[1],s=c[2]);const r=M(o),l=$(e);let a=[];const i=t=>{let o=+r.call(t,l);for(;a.length>o;){const t=a.pop();g(t),t.remove()}let c=a.length+1,i=a[c-1]||e;for(;a.length<o;){let e=n.cloneNode(!0);v(l,e)[s]=c++,P(e,t),a.push(e),i.after(e),i=e}};y(t,e,i,x(o)),i(t)}));export{W as Attr,q as Component,U as CustomElement,G as Prop,e as addDirective,_ as attr,B as component,H as emit,x as findBindings,c as metadataControllerElement,O as parseText,K as prop,F as update};