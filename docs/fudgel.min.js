const t=()=>{const t=new WeakMap;return(s,n)=>t.get(s)||n&&t.set(s,n).get(s)},s=t(),n=t(),o=t(),e=new Map,c=t(),r=t(),i=t(),l=t(),f={},h=t(),u=t(),a=(t,s,...n)=>{d(f,t,s,...n),d(h(s)||{},t,...n)},d=(t,s,...n)=>{for(const o of t[s]||[])t[s].includes(o)&&o(...n)},p=t=>{const s=[t];let n;for(;n=s.shift();){for(const t of u(n,[]))t();for(const t of n.childNodes)s.push(t)}},m=(t,s,n,o)=>{const e=h(t,{});e[n]?e[n].push(o):e[n]=[o];u(s,[]).push((()=>{const s=h(t);s&&s[n]&&(s[n]=s[n].filter((t=>t!==o)))}))},w=(t,s)=>((f[t]||(f[t]=[])).push(s),()=>{f[t]=f[t].filter((t=>t!==s))}),$=(t,s,n,o={})=>{t.dispatchEvent(new CustomEvent(s,{bubbles:!0,cancelable:!1,composed:!0,detail:n,...o}))},b=(t,s,n,o={})=>{const c=e.get(t);c&&$(c,s,n,o)},g=(t,s)=>{if(t)E(t,s);else for(const t of e.keys())E(t)},E=(t,s)=>{if(t.onChange){const s=o(t);for(const n of[...s.prop||[],...s.attr||[]])t.onChange(n,t[n],t[n])}a(`set:${s||""}`,t,t)},k=t=>t.entries?t.entries():Object.entries(t),C=t=>{const s=new Map;return n=>{if(s.has(n))return s.get(n);const o=t(n);return s.set(n,o),o}},S=t=>t.replace(/-(\p{Ll})/gu,(t=>t[1].toUpperCase())),_=t=>t.replace(/\p{Lu}/gu,(t=>`-${t[0]}`.toLowerCase())),M=t=>null==t?"":`${t}`,v=t=>"string"==typeof t,y=(t,s)=>t.getAttribute(s),x=t=>{const s=e.get(t);return s?s.shadowRoot||s:null},L=(t,s,n)=>{!0===n&&(n=""),v(n)?t.setAttribute(s,n):t.removeAttribute(s)},T=(t,s)=>[...new Set([...t,...s])],O=(t,s)=>"function"==typeof t[s]?t[s].bind(t):t[s],j=document||{},A=window||{},P=t=>t.cloneNode(!0),H=t=>j.createElement(t),N=()=>j.createDocumentFragment(),F=t=>{const s=H("style");return s.append((t=>j.createTextNode(t))(t)),s},G=()=>H("template"),J=(t,s)=>j.createTreeWalker(t,s),K=t=>{const s=j.implementation.createHTMLDocument(""),n=s.createElement("style");return n.textContent=t,s.body.append(n),n.sheet.cssRules||[]},R=(t,s,n)=>{const o=i(t,{});let e=o[s];if(!e){let n=t[s];const c=Object.getOwnPropertyDescriptor(t,s)||{};e=[],o[s]=e,Object.defineProperty(t,s,{get:c.get||(()=>n),set:function(t){const s=n;if(t!==s){c.set?c.set(t):n=t;for(const n of e)n(this,t,s)}}})}e.push(n)};function W(t,s,n,o,e){m(t,s,"set:",n);for(const c of o){const o=`set:${c}`;c in e?(R(e,c,((s,n,e)=>{a(o,s,t,n,e)})),m(e,s,o,n)):(R(t,c,((t,s,n)=>{a(o,t,t,s,n),t.onChange&&t.onChange(c,s,n)})),m(t,s,o,n))}}const q=t=>{let s=l(t);if(t){let n=t.parentNode;for(;!s&&n;)s=l(n),n=n.parentNode}return s||(s={},l(j.body,s)),s},z=(t,s)=>{const n=Object.create(t);return l(s,n),n},B=(t,s)=>new Proxy(t,{get:(t,n)=>O(n in s?s:t,n)});let D="",I=0,Q=0;const U={b:"\b",f:"\f",n:"\n",r:"\r",t:"\t",v:"\v"},V={"-":t=>s=>-t(s),"!":t=>s=>!t(s),"~":t=>s=>~t(s),"+":t=>s=>+t(s)},X={"||":[1,(t,s)=>n=>t(n)||s(n)],"&&":[2,(t,s)=>n=>t(n)&&s(n)],"|":[3,(t,s)=>n=>t(n)|s(n)],"^":[4,(t,s)=>n=>t(n)^s(n)],"&":[5,(t,s)=>n=>t(n)&s(n)],"==":[6,(t,s)=>n=>t(n)==s(n)],"!=":[6,(t,s)=>n=>t(n)!=s(n)],"===":[6,(t,s)=>n=>t(n)===s(n)],"!==":[6,(t,s)=>n=>t(n)!==s(n)],"<":[7,(t,s)=>n=>t(n)<s(n)],">":[7,(t,s)=>n=>t(n)>s(n)],"<=":[7,(t,s)=>n=>t(n)<=s(n)],">=":[7,(t,s)=>n=>t(n)>=s(n)],"<<":[8,(t,s)=>n=>t(n)<<s(n)],">>":[8,(t,s)=>n=>t(n)>>s(n)],">>>":[8,(t,s)=>n=>t(n)>>>s(n)],"+":[9,(t,s)=>n=>t(n)+s(n)],"-":[9,(t,s)=>n=>t(n)-s(n)],"*":[10,(t,s)=>n=>t(n)*s(n)],"/":[10,(t,s)=>n=>t(n)/s(n)],"%":[10,(t,s)=>n=>t(n)%s(n)]},Y={true:()=>!0,false:()=>!1,null:()=>null},Z=t=>{D=t,I=0,tt(0);let s=[()=>{},[]];try{s=rt()||et()}catch(t){}return s},tt=(t=1)=>{I+=t,Q=D.charCodeAt(I)},st=()=>D.charAt(I),nt=t=>t>=48&&t<=57,ot=t=>t>=65&&t<=90||t>=97&&t<=122||t>=128||36===t||95===t,et=()=>{const t=`Parse error at index ${I}: ${D}`;throw console.error(t),new Error(t)},ct=()=>{for(;32===Q||9===Q||10===Q||13===Q;)tt()},rt=()=>{const t=lt();return ct(),t},it=()=>{ct();let t,s=D.substr(I,3),n=3;for(;n>0;){if(t=X[s],t){tt(n);break}s=s.substr(0,--n)}return t},lt=()=>{let t,s,n,o,e,c,r;if(e=ft(),!e)return e;if(s=it(),!s)return e;for(c=ft()||et(),o=[e,s,c],r=()=>{let t=o.pop(),s=o.pop(),n=o.pop();o.push([s[1](n[0],t[0]),T(n[1],t[1])])};n=it();){for(;o.length>2&&n[0]<=o[o.length-2][0];)r();t=ft()||et(),o.push(n,t)}for(;o.length>1;)r();return o[0]},ft=()=>{let t;if(ct(),nt(Q)||46===Q)return ut();if(39===Q||34===Q)t=at();else{const s=V[st()];if(s){tt();const t=ft()||et();return[s(t[0]),t[1]]}ot(Q)||et();const n=dt();t=Y[n]?[Y[n],[]]:[t=>O(t,n),[n]]}return ht(t)},ht=t=>{for(ct();46===Q||91===Q||40===Q||63===Q;){let s,n,o=[],e=t;if(63===Q&&(tt(),ct(),46!==Q&&et(),s=!0),91===Q){tt();const t=rt()||et();n=(s,n)=>O(s,t[0](n)),o=t[1],93!==Q&&et(),tt()}else if(40===Q){tt();const t=pt();n=(s,n)=>s(...t.map((t=>t[0](n)))),o=t.reduce(((t,s)=>T(t,s[1])),o)}else if(46===Q){tt(),ct();const t=dt();n=s=>O(s,t)}else et();t=s?[t=>{const s=e[0](t);return void 0===s?void 0:n(s,t)},T(e[1],o)]:[t=>n(e[0](t),t),T(e[1],o)],ct()}return t},ut=()=>{let t="";for(;nt(Q);)t+=st(),tt();if(46===Q)for(t+=".",tt();nt(Q);)t+=st(),tt();if(101===Q||69===Q){t+=st(),tt(),43!==Q&&45!==Q||(t+=st(),tt());let s=!0;for(;nt(Q);)t+=st(),tt(),s=!1;s&&et()}ot(Q)?et():46!==Q&&"."!==t||et();const s=parseFloat(t);return[()=>s,[]]},at=()=>{let t="";const s=Q;for(tt();I<D.length&&Q!==s;){if(92===Q){tt();const s=st();t+=U[s]||s}else t+=st();tt()}return I>=D.length&&et(),tt(),[()=>t,[]]},dt=()=>{let t=I;for(ot(Q)?tt():et();I<D.length&&(ot(Q)||nt(Q));)tt();return D.slice(t,I)},pt=()=>{const t=[];for(ct();41!==Q;)I>=D.length&&et(),t.push(rt()||et()),ct(),44===Q?(tt(),ct()):41!==Q&&et();return tt(),t},mt=t=>{const s=t.split(/{{(.*?)}}/);if(s.length<2)return null;const n=[];let o=!1,e=[];for(const t of s){if(o){const s=Z(t);n.push(s[0]),e=T(e,s[1])}else n.push(t);o=!o}return[n,e]},wt=t=>t?[s=>t[0].map((t=>M(t&&t.call?t(s):t))).join(""),t[1]]:null,$t=C((t=>{const s=mt(t);return s&&3===s[0].length&&""===s[0][0]&&""===s[0][2]?[t=>{const n=s[0][1](t);return"boolean"==typeof n?n:M(n)},s[1]]:wt(s)})),bt=C((t=>wt(mt(t)))),gt={window:()=>{},document:()=>{},stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:(t,s)=>t.target!==s,outside:(t,s)=>s.contains(t.target),ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>0!==t.button,middle:t=>1!==t.button,right:t=>2!==t.button,exact:(t,s,n)=>["ctrl","shift","alt","meta"].some((s=>t[`${s}Key`]&&!n.has(s)))},Et=[{"*for":(t,s,n,o)=>{let e="key",c="value";const r=o.match(/^\s*(?:(?:(\S+)\s*,\s*)?(\S+)\s+of\s+)?(\S+)\s*$/);r&&(e=r[1]||e,c=r[2]||c,o=r[3]);const i=Z(o),l=q(s);let f=new Map;const h=t=>{const o=i[0](B(t,l))||[];let r=f;f=new Map;let h=s;for(const[s,i]of k(o)){let o=r.get(s);if(r.delete(s),o===h.nextSibling){q(o)[c]=i}else{o&&(p(o),o.remove()),o=P(n);const r=z(l,o);r[e]=s,r[c]=i,vt(o,t),h.after(o)}h=o,f.set(s,h)}for(const t of r.values())p(t),t.remove()};W(t,s,h,i[1],l),h(t)},"*if":(t,s,n,o)=>{const e=Z(o),c=q(s);let r=null;const i=t=>{e[0](B(t,c))?r||(r=P(n),z(c,r),vt(r,t),s.after(r)):r&&(p(r),r.remove(),r=null)};W(t,s,i,e[1],c),i(t)},"*repeat":(t,s,n,o)=>{let e="index";const c=o.match(/^(\S+)\s+as\s+(\S+)$/);c&&(o=c[1],e=c[2]);const r=Z(o),i=q(s);let l=[];const f=t=>{let o=+r[0](B(t,i));for(;l.length>o;){const t=l.pop();p(t),t.remove()}let c=l.length+1,f=l[c-1]||s;for(;l.length<o;){let s=P(n);z(i,s)[e]=c++,vt(s,t),l.push(s),f.after(s),f=s}};W(t,s,f,r[1],i),f(t)}},{"":(t,s,n,o)=>{const e=$t(n);if(e){const n=q(s),c=t=>{L(s,o,e[0](B(t,n)))};W(t,s,c,e[1],n),c(t)}},"@":(t,s,n,o)=>{const[e,...c]=S(o.slice(1)).split("."),r=Object.create(q(s)),i=Z(n),l={},f=new Set(c);let h=s;for(const t of["passive","capture","once"])f.has(t)&&(l[t]=!0);f.has("window")&&(h=A),(f.has("document")||f.has("outside"))&&(h=j),h.addEventListener(e,(n=>{c.some((t=>(gt[t]||(s=>{return n=s.key,_(n.replace(/^\p{Lu}/gu,(t=>t.toLowerCase())))!==(t.match(/^code-\d+$/)?String.fromCodePoint(+t.split("-")[1]):t);var n}))(n,s,f)))||(s=>{r.$event=s,i[0](B(t,r))})(n)}),l),L(s,o)},"#ref":(t,s,n,o)=>{t[S(n)]=s,L(s,o)},".":(t,s,n,o)=>{const e=Z(n),c=S(o.slice(1)),r=q(s),i=t=>{const n=e[0](B(t,r));s[c]=n};W(t,s,i,e[1],r),i(t),L(s,o)}}],kt=(t,s)=>Et["*"===t.charAt(0)?0:1][t]=s;function Ct(t,s){if(1===s.nodeType)for(const n of[...s.attributes]){const o=n.nodeName,e=o.charAt(0),c=Et[1],r=c[o]||c[e]||c[""];r&&r(t,s,n.nodeValue||"",o)}}const St=(t,s,n)=>{const o=n.attributes;if(1===n.nodeType&&o){let r;for(const[t,s]of k(Et[0])){const n=o.getNamedItem(t);if(n){if(r)throw new Error(`${r[0]} breaks ${t}`);r=[t,s,n.nodeValue||""]}}if(r){const o=(e=`${r[0]}=${c=r[2],JSON.stringify(c)}`,j.createComment(e));return n.before(o),s.previousNode(),n.remove(),L(n,r[0]),r[1](t,o,n,r[2],r[0]),1}}var e,c};function _t(t,s){if(3===s.nodeType){const n=bt(s.textContent||"");if(n){const o=q(s),e=t=>{s.nodeValue=n[0](B(t,o))};return W(t,s,e,n[1],o),e(t),1}}}const Mt=(t,s)=>{const n=J(t,133);let o;for(;o=n.nextNode();)"TEMPLATE"===o.nodeName&&Mt(o.content,s),St(s,n,o)||_t(s,o)||Ct(s,o)},vt=(t,s)=>{const n=N();n.append(t),Mt(n,s)};class yt extends HTMLElement{constructor(){super()}attributeChangedCallback(t,s,n){const o=S(t),e=c(this);e&&this.o(e,o,n)}connectedCallback(){const t=this.constructor,r=new(n(t)),i=s(t),l=i.useShadow,f=l?this.shadowRoot||this.attachShadow({mode:"open"}):this;c(this,r),e.set(r,this),o(r,i),this.classList.add(i.className),this.i(i,r),r.onInit&&r.onInit(),a("init",r,r);const h=G();h.innerHTML=i.template,Mt(h.content,r),l||this.l(),i.style&&f.append(F(i.style)),f.append(h.content),r.onViewInit&&r.onViewInit()}disconnectedCallback(){const t=c(this);t&&t.onDestroy&&t.onDestroy(),p(this),e.delete(t),this.l()}i(t,s){for(const n of t.prop||[]){const t=(t,s)=>{const o=c(t);this.o(o,n,s)};R(this,n,t),t(this,this[n]);const o=(t,s)=>{const o=e.get(t);o&&(o[n]=s)};R(s,n,o),o(s,s[n])}for(const n of t.attr||[]){const o=_(n);if(this.o(s,n,y(this,o)),!(t.prop||[]).includes(n)){R(s,n,((t,s)=>{const n=e.get(t);n&&L(n,o,s)}))}}}o(t,s,n){const o=t[s];t[s]=n,t.onChange&&t.onChange(s,o,n)}l(){this.innerHTML="",this.shadowRoot&&(this.shadowRoot.innerHTML="")}}let xt=new Map,Lt=()=>{var t;xt=A[t="__fudgel"]||(A[t]=xt),Lt=()=>{}};const Tt=(t,s)=>n=>{jt(t,s,n)},Ot=customElements,jt=(t,o,e)=>{Lt();const c=`fudgel-${(()=>{const t=xt.get("n")||0;return xt.set("n",t+1),t})()}`,r=Pt(o.style||"",t,c,o.useShadow),i={...o,className:c,style:r};class l extends yt{}l.observedAttributes=(i.attr||[]).map(_),s(l,i),n(l,e||class{});const f=G();f.innerHTML=i.template,At(f,c),i.template=f.innerHTML,a("component",l,l,i),Ot.get(t)||Ot.define(t,l)},At=(t,s)=>{const n=J(t.content,1);let o;for(;o=n.nextNode();)"TEMPLATE"===o.nodeName&&At(o,s),o.classList.add(s)},Pt=(t,s,n,o)=>{const e=(t,s)=>{t[Ht]&&(t[Ht]=t[Ht].split(",").map((t=>c(t,s))).join(","),s="");for(const n of t.cssRules||[])e(n,s);return t.cssText},c=(t,s)=>{const e=t=>`${t}.${n}`,c=(t,s)=>t.replace(/:host/,s),r=c(t=t.trim(),"")===t;return o?(r||t.includes(" "))&&(t=e(t)):(t=c(t,s),r&&(t=`${s} ${e(t)}`)),t};return[...K(t)].map((t=>e(t,s))).join("")},Ht="selectorText",Nt=new Map,Ft=[],Gt=t=>{if(Ft.includes(t))throw Ft.push(t),new Error(`Circular dependency: ${Ft.map((t=>`${t.name}`)).join(" -> ")}`);Ft.push(t);const s=Nt.get(t)||Nt.set(t,new t).get(t);return Ft.pop(),s},Jt=(t,s)=>{Nt.set(t,s)};class Kt{constructor(){this.h=new Map,this.on=(t,s)=>this.u(t).push(s)&&(()=>this.off(t,s)),this.u=t=>this.h.get(t)||this.h.set(t,[]).get(t)}emit(t,...s){for(const n of[...this.u(t)])n(...s)}off(t,s){const n=this.u(t);for(let t=n.length-1;t>=0;t-=1)n[t]===s&&n.splice(t,1)}}class Rt extends HTMLElement{constructor(){super(),this.p=N(),this.m=[],this.$=[],this.k=[];let t=this.children,s=t[0];if("TEMPLATE"===s.nodeName)this.$=Array.from(s.content.children);else for(;t.length>0;){const s=t[0];this.$.push(s),this.p.append(s)}}connectedCallback(){this.C(A,"popstate",this.S),this.C(j.body,"click",this._),this.M(A.location.pathname),this.L(A.history,"pushState",this.T),this.L(A.history,"replaceState",this.T)}disconnectedCallback(){for(;this.k.length;)this.k.pop()()}go(t){A.history.pushState(null,"",t)}O(t){let s=!1;if(t.e!==this.m[0]){const n=y(t.e,"title"),o=y(t.e,"component");this.innerHTML="",n&&(j.title=n),this.m=[t.e,o?H(o):P(t.e)],s=!0}const n=this.m[1];for(const[s,o]of t.g)L(n,_(s),o);s&&this.append(n)}_(t){if(!t.defaultPrevented){const s=t.composedPath().filter((t=>"A"===t.tagName))[0];s&&s.href&&s.origin===A.location.origin&&(t.preventDefault(),this.go(`${s.pathname}${s.search}${s.hash}`))}}C(t,s,n){const o=n.bind(this);t.addEventListener(s,o),this.k.push((()=>t.removeEventListener(s,o)))}j(t){for(const s of this.$){const n=y(s,"path")||"**",o=y(s,"regexp");let e=n;v(o)||(e=n.replace(/\*+/g,(t=>t.length>1?".*":"[^/]*")).replace(/:[^:\/]+/g,(t=>`(?<${t.slice(1)}>[^/]+)`)));const c=new RegExp(`^${e}(/.*)?$`),r=t.match(c);if(r)return{e:s,g:Object.entries(r.groups||{})}}return null}T(t,s){return(n,o,e)=>{s.call(t,n,o,e),this.M(e||"/")}}L(t,s,n){const o=t[s];t[s]=n.call(this,t,o),this.k.push((()=>t[s]=o))}S(){this.M(A.location.pathname)}M(t){const s=this.j(t);s&&this.O(s),$(j.body,"routeChange",t)}}const Wt=(t="router-outlet")=>{customElements.define(t,Rt)},qt=(t,s)=>t.n[s]||(t.n[s]=N()),zt=t=>t.parentElement||(t.getRootNode()||{}).host;class Bt extends HTMLElement{constructor(){super();let t=zt(this);for(;t&&!(this.A=r(t));)t=zt(t)}attributeChangedCallback(t,s,n){const o=this.A;o&&s!==n&&(this.P(o,s),this.H(o))}connectedCallback(){const t=this.A;t&&(l(this,t.s),this.H(t))}disconnectedCallback(){this.A&&this.P(this.A,y(this,"name")||"")}H(t){const s=y(this,"name")||"";this.append(t.n[s]||[]),this.N=t.e.on(s,(()=>{this.P(t,s),this.H(t)}))}P(t,s){this.N(),qt(t,s).append(...this.childNodes),t.e.emit(s)}}Bt.observedAttributes=["name"];const Dt=(t="slot-like")=>{customElements.define(t,Bt),w("component",((s,n)=>{if(!n.useShadow){const s=G();s.innerHTML=n.template;const o=J(s.content,1);let e;for(;e=o.nextNode();)if("SLOT"===e.nodeName){const s=H(t);for(const t of e.attributes)L(s,t.name,t.value);o.previousNode(),s.append(...e.childNodes),e.replaceWith(s)}n.template=s.innerHTML}})),w("init",(t=>{const s=x(t),n=o(t);if(s&&!n.useShadow){const n={e:new Kt,n:{"":N()},s:q(zt(e.get(t)))};for(const t of s.querySelectorAll("[slot]"))qt(n,y(t,"slot")||"").append(t);for(const t of s.childNodes)n.n[""].append(t);r(s,n)}}))},It=(t,...s)=>String.raw({raw:t},...s),Qt=It;export{Tt as Component,yt as CustomElement,Kt as Emitter,kt as addDirective,jt as component,Qt as css,Wt as defineRouterComponent,Dt as defineSlotComponent,Gt as di,Jt as diOverride,$ as dispatchCustomEvent,b as emit,y as getAttribute,w as hookOnGlobal,It as html,e as metadataControllerElement,bt as parseText,$t as parseTextAllowBoolean,x as rootElement,L as setAttribute,g as update,E as updateController};